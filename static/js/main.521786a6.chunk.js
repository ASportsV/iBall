(this.webpackJsonpiball=this.webpackJsonpiball||[]).push([[0],{11:function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"a",(function(){return f})),n.d(t,"i",(function(){return v}));var a=n(10),r={2760:{fn:"Anderson",ln:"Varejao",offSpeed:4.07,team:"GSW",star:!1},2738:{fn:"Andre",ln:"Iguodala",offSpeed:3.78,team:"GSW",star:!1},101106:{fn:"Andrew",ln:"Bogut",offSpeed:3.5,team:"GSW",star:!1},201575:{fn:"Brandon",ln:"Rush",offSpeed:4.09,team:"GSW",star:!1},203110:{fn:"Draymond",ln:"Green",offSpeed:3.49,team:"GSW",star:"defender"},203105:{fn:"Festus",ln:"Ezeli",offSpeed:3.97,team:"GSW",star:!1},203084:{fn:"Harrison",ln:"Barnes",offSpeed:4.02,team:"GSW",star:!1},203546:{fn:"Ian",ln:"Clark",offSpeed:4.07,team:"GSW",star:!1},203949:{fn:"James Michael",ln:"McAdoo",offSpeed:4.27,team:"GSW",star:!1},1626172:{fn:"Kevon",ln:"Looney",offSpeed:4.05,team:"GSW",star:!1},202691:{fn:"Klay",ln:"Thompson",offSpeed:3.85,team:"GSW",star:"shooter"},2571:{fn:"Leandro",ln:"Barbosa",offSpeed:3.88,team:"GSW",star:!1},201578:{fn:"Marreese",ln:"Speights",offSpeed:3.67,team:"GSW",star:!1},2733:{fn:"Shaun",ln:"Livingston",offSpeed:3.85,team:"GSW",star:!1},201939:{fn:"Stephen",ln:"Curry",offSpeed:3.68,team:"GSW",star:"shooter"},201574:{fn:"Jason",ln:"Thompson",offSpeed:3.68,team:"GSW",star:!1},101112:{fn:"Channing",ln:"Frye",offSpeed:3.61,team:"CLE",star:!1},2563:{fn:"Dahntay",ln:"Jones",offSpeed:4.31,team:"CLE",star:!1},202697:{fn:"Iman",ln:"Shumpert",offSpeed:4.08,team:"CLE",star:!1},2747:{fn:"JR",ln:"Smith",offSpeed:3.92,team:"CLE",star:!1},2592:{fn:"James",ln:"Jones",offSpeed:3.84,team:"CLE",star:!1},203099:{fn:"Jared",ln:"Cunningham",offSpeed:4.24,team:"CLE",star:!1},203925:{fn:"Joe",ln:"Harris",offSpeed:4.6,team:"CLE",star:!1},203895:{fn:"Jordan",ln:"McRae",offSpeed:3.6,team:"CLE",star:!1},201567:{fn:"Kevin",ln:"Love",offSpeed:3.86,team:"CLE",star:!1},202681:{fn:"Kyrie",ln:"Irving",offSpeed:3.78,team:"CLE",star:!1},2544:{fn:"LeBron",ln:"James",offSpeed:3.72,team:"CLE",star:"star"},203521:{fn:"Matthew",ln:"Dellavedova",offSpeed:3.9,team:"CLE",star:!1},2590:{fn:"Mo",ln:"Williams",offSpeed:3.92,team:"CLE",star:!1},2210:{fn:"Richard",ln:"Jefferson",offSpeed:3.96,team:"CLE",star:!1},201619:{fn:"Sasha",ln:"Kaun",offSpeed:4.12,team:"CLE",star:!1},202389:{fn:"Timofey",ln:"Mozgov",offSpeed:4.12,team:"CLE",star:!1},202684:{fn:"Tristan",ln:"Thompson",offSpeed:4.1,team:"CLE",star:!1},201566:{fn:"Russell",ln:"Westbrook",offSpeed:3.71,team:"OKC",star:"shooter"},201627:{fn:"Anthony",ln:"Morrow",offSpeed:3.8,team:"OKC",star:!1},203079:{fn:"Dion",ln:"Waiters",offSpeed:3.74,team:"OKC",star:!1},2555:{fn:"Nick",ln:"Collison",offSpeed:3.9,team:"OKC",star:!1},202713:{fn:"Kyle",ln:"Singler",offSpeed:4.21,team:"OKC",star:!1},200779:{fn:"Steve",ln:"Novak",offSpeed:3.87,team:"OKC",star:!1},201586:{fn:"Serge",ln:"Ibaka",offSpeed:3.67,team:"OKC",star:!1},202683:{fn:"Enes",ln:"Kanter",offSpeed:3.89,team:"OKC",star:!1},203500:{fn:"Steven",ln:"Adams",offSpeed:3.79,team:"OKC",star:!1},201571:{fn:"D.J.",ln:"Augustin",offSpeed:3.84,team:"OKC",star:!1},203460:{fn:"Andre",ln:"Roberson",offSpeed:4.36,team:"OKC",star:!1},1626166:{fn:"Cameron",ln:"Payne",offSpeed:4.11,team:"OKC",star:!1},201142:{fn:"Kevin",ln:"Durant",offSpeed:3.47,team:"OKC",star:"shooter"},202362:{fn:"Lance",ln:"Stephenson",offSpeed:3.98,team:"LAC",star:!1},101108:{fn:"Chris",ln:"Paul",offSpeed:3.67,team:"LAC",star:"star"},200755:{fn:"Redick",ln:"JJ",offSpeed:4.11,team:"LAC",star:!1},2746:{fn:"Josh",ln:"Smith",offSpeed:3.72,team:"LAC",star:!1},201599:{fn:"DeAndre",ln:"Jordan",offSpeed:3.68,team:"LAC",star:!1},203143:{fn:"Pablo",ln:"Prigioni",offSpeed:4.46,team:"LAC",star:!1},2037:{fn:"Jamal",ln:"Crawford",offSpeed:3.72,team:"LAC",star:!1},201601:{fn:"Luc",ln:"Mbah a Moute",offSpeed:4.08,team:"LAC",star:!1},203085:{fn:"Austin",ln:"Rivers",offSpeed:4.13,team:"LAC",star:!1},201933:{fn:"Blake",ln:"Griffin",offSpeed:3.56,team:"LAC",star:!1},202325:{fn:"Wesley",ln:"Johnson",offSpeed:4.06,team:"LAC",star:!1},1718:{fn:"Paul",ln:"Pierce",offSpeed:3.54,team:"LAC",star:!1},202332:{fn:"Cole",ln:"Aldrich",offSpeed:3.96,team:"LAC",star:!1}},i=(Object.entries(r).reduce((function(e,t){var n=Object(a.a)(t,2),r=n[0];n[1];return e[+r]=.6*Math.random(),e}),{}),20),o=1.8,c={off:.03,on:.6},s=8,l=4,u={min:10,max:630,mina:.2,maxa:.35},d=[360,18e3/94],f={offense_inner_border:"#f5f5f5",offense_bg_fill:"#f5f5f577",offense_outer_border:"rgba(220, 220, 220, 0.1)",defense_bg_fill:"rgba(255, 255, 255, 0.15)",defense_fg_fill:"#f5f5f5",player_name:"#f5f5f5",BG_MASK_ALPHA:.3,FG_MASK_ALPHA:.2,off_df_link:"255, 255, 255",star_name:"rgb(255, 243, 194)",star_star:"rgb(255, 243, 194)"},v={game2_unit0:[],game1_unit0:["4_,","5_c,t","6_,"],game1_unit1:["4_,","5_c,t","6_,","7_c,t","8_c,","9_c,t","10_,","11_c,t","12_,","13_c,t","14_c,","15_c,t"],game1_unit2:["16_,","17_c,t","18_,l","19_c,t","20_,","21_c,t","22_,","23_c,t","24_,l","25_c,t","26_,l","27_,l","28_,l","30_,"],game2_unit1:["0_,","1_c,t","2_,t","3_c,","4_c,t","5_c,","6_c,t","7_c,l","8_c,t","9_c,","10_c,t"],game2_unit2:["11_,t","12_c,l","13_c,","14_c,t","15_c,","16_c,t","17_,l","18_c,t","19_,t","20_c,","21_c,t","22_c,l","23_c,t","24_,l","25_c,t","26_,","27_c,t","28_,","29_c,t","30_,t","31_c,","32_c,t","33_,t","34_c,","35_c,t"]}},34:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var a=n(2),r=n(3),i=n(11),o=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"game1",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unit0";Object(a.a)(this,t),this.GAME_ID=n,this.UNIT_ID=r,console.log(e.location.search),console.debug("%cParams:\n    GAME_ID: ".concat(n,",\n    UNIT_ID: ").concat(r,",\n    "),"background: #444; color: #bada55; padding: 2px; border-radius:2px")}return Object(r.a)(t,[{key:"VIDEO_IDS",get:function(){return i.i["".concat(this.GAME_ID,"_").concat(this.UNIT_ID)]}}]),t}();var c=function(){var t=new URLSearchParams(e.location.search),n="game1";null!==t.get("g")&&(n="game".concat(t.get("g"))),["game1","game2"].includes(n)||alert("GameId must be game1 or game2");var a="unit0";null!==t.get("u")&&(a="unit".concat(t.get("u"))),["unit0","unit1","unit2"].includes(a)||alert("UnitId must be unit0, unit1, or unit2");var r="FULL";return null!==t.get("m")&&(r=t.get("m").toUpperCase()),["AUG","FULL","RAW"].includes(r)||alert("Mode must be RAW, AUG, or FULL"),null!==t.get("gf")&&t.get("gf"),null!==t.get("gi")&&t.get("gi"),new o(n,a)}()}).call(this,n(47))},52:function(e,t,n){"use strict";var a,r;!function(e){e.MIDDLE="MIDDLE",e.LEFT="LEFT",e.RIGHT="RIGHT"}(a||(a={})),function(e){e.N="NORTH",e.S="SOUTH",e.E="EAST",e.W="WEST",e.NE="NORTH_EAST",e.NW="NORTH_WEST",e.SE="SOUTH_EAST",e.SW="SOUTH_WEST"}(r||(r={}))},53:function(e,t){},54:function(e,t){},55:function(e,t){},56:function(e,t){},76:function(e,t,n){},86:function(e,t,n){},87:function(e,t,n){"use strict";var a;n(52),n(53),n(54),n(55),n(56);!function(e){e[e.Far=1]="Far",e[e.Near=0]="Near",e[e.Both=-1]="Both"}(a||(a={}))},89:function(e,t,n){},90:function(e,t,n){},91:function(e,t,n){},92:function(e,t,n){},93:function(e,t,n){},94:function(e,t,n){"use strict";n.r(t);var a=n(12),r=n.n(a),i=n(59),o=n.n(i),c=n(10),s=n(13),l=n(14),u=n(15),d=n(1),f=n.n(d),v=n(4),h=n(2),p=n(3),b=n(17),m=n(7),O=n(8),g=n(9),y=n(19),j=(n(76),n(77),n(78),n(60)),x=n.n(j),_=n(48),S=n(40),k=n(65),A=n(11),E=!1,w=!0,I=!0,T=!1,C=.25,P=n(5);function L(e,t){return e.reduce((function(e,n){return e[n[t]]=n,e}),{})}function M(e,t){var n,a=new Set(e),r=Object(P.a)(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;a.add(i)}}catch(o){r.e(o)}finally{r.f()}return a}function F(e){return R.apply(this,arguments)}function R(){return(R=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){setTimeout(e,t)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e){return G.apply(this,arguments)}function G(){return(G=Object(v.a)(f.a.mark((function e(t){var n,a=arguments;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:70,e.abrupt("return",new Promise((function(e){setInterval((function(){t()&&e(null)}),n)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e){return(e/1024/1024).toFixed(2)}function H(){var e=performance.memory;console.debug("Used / Total: ".concat(B(e.usedJSHeapSize),"mb / ").concat(B(e.totalJSHeapSize),"mb"))}var D=0;function W(){return++D}function V(e){return Z.apply(this,arguments)}function Z(){return(Z=Object(v.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new Image).src=t,e.next=4,new Promise((function(e){n.onload=function(n){URL.revokeObjectURL(t),e(void 0)}}));case 4:return e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e,t){var n=0,a=0;for(a=0;a<t.length;++a){var r=t[a];if(e>=n&&e<n+r.maxFrame)break;n+=r.maxFrame}return{videoIdx:a,frameIdx:e-n}}var U=function(e,t){var n=e.x-t.x,a=e.y-t.y;return Math.sqrt(n*n+a*a)};function Y(e,t,n,a){var r=n-e,i=a-t,o=r||i?Math.atan2(i,r):0;return o<0&&(o+=2*Math.PI),o*(180/Math.PI)}function J(e,t,n){var a=new e;return Object(v.a)(f.a.mark((function e(){var r,i,o,c=arguments;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=c.length,i=new Array(r),o=0;o<r;o++)i[o]=c[o];return a.postMessage([t].concat(i)),e.next=4,new Promise((function(e){a.addEventListener("message",(function r(i){i.data[0]===t?(a.removeEventListener("message",r),e(i.data[1])):null===n||void 0===n||n(i.data)}))}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))}var K,X,Q;n(86),n(87);function q(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,a=e.canvas,r=a.width,i=a.height;e.ctx.drawImage(t,0,0,r,i),0!==n&&$(e,n)}function $(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:C,n=e.ctx,a=e.canvas,r=a.width,i=a.height;n.save(),n.fillStyle="rgba(0, 0, 0, ".concat(t,")"),n.fillRect(0,0,r,i),n.restore()}!function(e){e.offensive="in_offensive",e.defensive="in_defensive",e.other="in_other"}(K||(K={})),function(e){e[e.BALL_HOLDER=0]="BALL_HOLDER",e[e.NEXT_BALL_HOLDER=1]="NEXT_BALL_HOLDER",e[e.EMPTY_PLAYER=2]="EMPTY_PLAYER",e[e.STAR=3]="STAR"}(X||(X={})),function(e){e[e.Interest=1]="Interest",e[e.Normal=2]="Normal",e[e.Normal_Interest=3]="Normal_Interest"}(Q||(Q={}));var ee=document.createElement("canvas");ee.getContext("2d");function te(e){return Object.entries(e)}function ne(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(te(t).forEach((function(t){"lineWidth"===(null===t||void 0===t?void 0:t[0])&&void 0!==t[1]&&(e.lineWidth=t[1]),"strokeStyle"===(null===t||void 0===t?void 0:t[0])&&void 0!==t[1]&&(e.strokeStyle=t[1]),"font"===(null===t||void 0===t?void 0:t[0])&&t[1]&&(e.font=t[1]),"textBaseline"===(null===t||void 0===t?void 0:t[0])&&t[1]&&(e.textBaseline=t[1]),"lineCap"===(null===t||void 0===t?void 0:t[0])&&t[1]&&(e.lineCap=t[1]),"lineJoin"===(null===t||void 0===t?void 0:t[0])&&t[1]&&(e.lineJoin=t[1])})),t.fillStyle){var n=t.fillStyle;"object"===typeof n&&"pattern"in n&&"opacity"in n?(e.fillStyle=n.pattern,e.globalAlpha=n.opacity):e.fillStyle=n}}var ae=function(e){return(e+2)%2};function re(e,t,n,a){!function(e,t){e.save();var n=1.7525735,a=.0598341402,r=-.891780472,i=.249200452;e.setTransform(n,a,r,i,0,0);var o=t.map((function(e){var t=e.cx,o=e.cy,c=(t-r/i*o-0-0)/(n-r/i*a);return{tx:c,ty:(t-0-n*c)/r}}));t.filter((function(e){return e.inOffsensiveCourt})).forEach((function(t,n){var a=o[n],r=a.tx,i=a.ty;e.fillStyle=A.a.offense_outer_border,e.beginPath(),e.arc(r,i,32,0,2*Math.PI),e.fill()})),t.forEach((function(t,n){var a=t.size,r=t.fill,i=o[n],c=i.tx,s=i.ty,l=10+22*a;e.fillStyle=r,e.beginPath(),e.arc(c,s,l,0,2*Math.PI),e.fill()})),e.globalCompositeOperation="destination-out",t.forEach((function(t,n){t.fill;var a=o[n],r=a.tx,i=a.ty;e.beginPath(),e.arc(r,i,10,0,2*Math.PI),e.fill()})),e.globalCompositeOperation="source-over",e.lineWidth=1,e.strokeStyle=A.a.offense_bg_fill,t.filter((function(e){return e.inOffsensiveCourt})).forEach((function(t,n){var a=o[n],r=a.tx,i=a.ty;e.beginPath(),e.arc(r,i,32,0,2*Math.PI),e.stroke()})),e.strokeStyle=A.a.offense_inner_border,t.forEach((function(t,n){var a=t.inOffsensiveCourt,r=o[n],i=r.tx,c=r.ty;e.lineWidth=a?1:3,e.beginPath(),e.arc(i,c,10,0,2*Math.PI),e.stroke()})),e.restore()}(e,t),function(e,t,n){e.save();var a=1.7525735,r=1e-7,i=.549200452;e.setTransform(a,1e-7,r,i,0,0);var o=function(e,t){var n=(e-r/i*t+0-0)/(a-r/i*1e-7);return{x:n,y:(e-0-a*n)/r}},s=function(e,t){var n=ae(e-.02-.13*Math.max(0,Math.min(1,1-(t-u)/l))),a=ae(e+.02+.13*Math.max(0,Math.min(1,1-(t-u)/l)));if(a<n&&!(n>1.5&&a<.5)||n<.5&&a>1.5){var r=[n,a];a=r[0],n=r[1]}return[n,a]},l=12,u=3.5;e.save();var d,f=Object(P.a)(t);try{for(f.s();!(d=f.n()).done;){var v=d.value,h=v.cx,p=v.cy,b=v.dx,m=v.dy,O=v.tdist;if(!(O>=l||O<=u)){var g=Y(h,p,b,m)/180;e.beginPath(),e.lineWidth=2;var y=o(h+40*Math.cos(g*Math.PI),p+40*Math.sin(g*Math.PI)),j=y.x,x=y.y,_=o(b-50*Math.cos(g*Math.PI),m-50*Math.sin(g*Math.PI)),S=_.x,k=_.y,E=e.createLinearGradient(j,x,S,k);E.addColorStop(0,"rgba(".concat(A.a.off_df_link,", 0.1)")),E.addColorStop(.1,"rgba(".concat(A.a.off_df_link,", ").concat(.3+(l-O)/l*.5,")")),E.addColorStop(.9,"rgba(".concat(A.a.off_df_link,", ").concat(.3+(l-O)/l*.5,")")),E.addColorStop(1,"rgba(".concat(A.a.off_df_link,", 0.1)")),e.strokeStyle=E,e.shadowColor="rgb(".concat(A.a.off_df_link,")"),e.shadowBlur=5,e.moveTo(j,x),e.lineTo(S,k),e.stroke()}}}catch(te){f.e(te)}finally{f.f()}e.restore();var w,I=100,T=Object(P.a)(t);try{for(T.s();!(w=T.n()).done;){var C=w.value,L=C.cx,M=C.cy,F=C.dx,R=C.dy,N=C.tdist,G=C.smoothDFdiff,B=104+15*Math.max(0,G);e.lineWidth=B-I;var H=Y(L,M,F,R)/180,D=Math.max(0,I*Math.sqrt(1/(Math.pow(Math.cos(H*Math.PI)/a,2)+Math.pow(Math.sin(H*Math.PI)/i,2)))-30),W=o(L-=D*Math.cos(H*Math.PI),M-=D*Math.sin(H*Math.PI)),V=W.x,Z=W.y,z=Math.atan(a*Math.tan(H*Math.PI)/i)/Math.PI;H>.5&&H<=1.5&&(z=(z+1)%2);var U=s(z,N),J=Object(c.a)(U,2),K=J[0],X=J[1],Q=s(z,u),q=Object(c.a)(Q,2),$=q[0],ee=q[1];e.strokeStyle=A.a.defense_bg_fill,e.beginPath(),e.arc(V,Z,I+(B-I)/2,$*Math.PI,ee*Math.PI),e.stroke(),e.strokeStyle=A.a.defense_fg_fill,e.beginPath(),e.arc(V,Z,I+(B-I)/2,K*Math.PI,X*Math.PI),e.stroke()}}catch(te){T.e(te)}finally{T.f()}e.restore()}(e,n)}function ie(e,t,n){e.save(),e.shadowColor="rgba(255, 255, 255, 0.5)",t.forEach((function(t){var a,r=t.bbox,i=r.x,o=r.y,c=r.w,s=r.h;e.shadowBlur=t.on?10:40*(null!==(a=t.att)&&void 0!==a?a:0-A.e.off),e.drawImage(n.canvas,i,o,c,s,i,o,c,s)})),e.restore()}function oe(e,t,n){null===t||void 0===t||t.forEach((function(t){var a=t.last.progress,r=t.bbox,i=r.x,o=r.y,s=r.w,l=r.h,u=t.type===X.EMPTY_PLAYER||t.type===X.STAR?30:20;e.drawImage(n.canvas,i,o,s,l,i,o,s,l),function(e,t){var n=t.x,a=t.y,r=t.r,i=t.h,o=t.r1,s=void 0===o?0:o,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e.save(),ne(e,l);for(var u=.1,d=[],f=[],v=[],h=0,p=0;h<=2*Math.PI+u;++p){var b=r*Math.cos(h),m=r*Math.sin(h);d[p]=[b,0,m],h+=u,b=s*Math.cos(h),m=s*Math.sin(h),f[p]=[b,-(1-s/r)*i,m]}for(var O=0,g=0;g<d.length-1;g++){var y=[f[O],d[O],d[O+1],f[O+1]];v[g]=y,O+=1}function j(e){for(var t=Math.sin(-e),n=Math.cos(-e),a=0;a<d.length;a++){var r=d[a],i=r[1],o=r[2];r[1]=i*n-o*t,r[2]=o*n+i*t,i=(r=f[a])[1],o=r[2],r[1]=i*n-o*t,r[2]=o*n+i*t}}j(20*Math.PI/180),e.translate(n,a);for(var x=0;x<v.length;x++){var _=Object(c.a)(v[x],4),S=_[0],k=_[1],A=_[2],E=_[3];e.beginPath(),e.moveTo(S[0],S[1]),e.lineTo(k[0],k[1]),e.lineTo(A[0],A[1]),e.lineTo(E[0],E[1]),e.lineTo(S[0],S[1]),e.fill(),e.closePath()}e.restore()}(e,{x:i+.5*s,y:o+l,r:a/6*50,r1:u*(a/6),h:t.type===X.EMPTY_PLAYER||t.type===X.STAR?800:1e3},{lineWidth:1,strokeStyle:"rgba(220, 220, 220, 0.05)",fillStyle:t.type===X.EMPTY_PLAYER?"rgba(50, 220, 128, 0.1)":t.type===X.STAR?"rgba(255,215,120, 0.08)":"rgba(220, 220, 220, 0.1)",lineCap:"round",lineJoin:"round"})}))}var ce=document.createElement("canvas"),se=ce.getContext("2d");function le(e,t,n,a){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=arguments.length>6?arguments[6]:void 0,c=arguments.length>7?arguments[7]:void 0,s=arguments.length>8?arguments[8]:void 0,l=e.canvas,u=l.width,d=l.height;if(ce.width=u,ce.height=d,se.save(),se.drawImage(n,0,0),se.globalCompositeOperation="source-in",se.drawImage(t,0,0),se.restore(),e.drawImage(ce,0,0),s){var f=s.pos;e.save();var v=e.createRadialGradient(f.x,f.y,A.c.min,f.x,f.y,A.c.max);v.addColorStop(0,"rgba(0, 0, 0, ".concat(A.c.mina,")")),v.addColorStop(1,"rgba(0, 0, 0, ".concat(A.c.maxa,")")),e.fillStyle=v,e.globalCompositeOperation="source-atop",e.fillRect(0,0,u,d),e.restore();var h=a.filter((function(e){return!i.find((function(t){return t.id===e.id}))&&!r.find((function(t){return t.id===e.id}))}));e.save(),h.forEach((function(t){var n=t.bbox,a=n.x,r=n.y,i=n.w,o=n.h;e.drawImage(se.canvas,a,r,i,o,a,r,i,o)})),e.restore()}var p=i.filter((function(e){var t;return e.id!==c&&e.type.has(Q.Interest)&&e.looked&&(null!==(t=e.att)&&void 0!==t?t:0)>A.e.off})),b=i.filter((function(e){return!p.find((function(t){return t.id===e.id}))}));b.forEach((function(t){var n=t.bbox,a=n.x,r=n.y,i=n.w,o=n.h;e.drawImage(se.canvas,a,r,i,o,a,r,i,o)})),ie(e,p,se),o.vis_key_player&&oe(e,r,se)}var ue=new Image;ue.src="".concat("/iBall","/shooter.png");var de=new Image;de.src="".concat("/iBall","/defender.png");var fe=new Image;fe.src="".concat("/iBall","/star.png");var ve={shooter:ue,defender:de,star:fe};function he(e,t,n,a){if("star"===a)he(e,t,[n[0]-t,n[1]],"shooter"),he(e,t,n,"defender");else{var r=t*ve[a].width/ve[a].height;ce.width=r,ce.height=t,se.save(),se.drawImage(ve[a],0,0,ve[a].width,ve[a].height,0,0,r,t),se.globalCompositeOperation="source-in",se.fillStyle=A.a.star_star,se.fillRect(0,0,r,t),se.restore(),e.drawImage(ce,n[0]-.5*r,n[1]-.5*t)}}function pe(e,t){if(t){var n=t.id,a=t.namePos,r=A.h[n].ln;e.save(),e.fillStyle=A.h[n].star?A.a.star_name:A.a.player_name,e.font="bold ".concat(18,"px Arial"),e.textAlign="center";var i=e.measureText(r).width,o="star"===A.h[n].star?a.x+9:a.x;if(e.fillText(r,o,a.y),e.restore(),A.h[n].star){he(e,18,[o-.5*(i+(Math.floor(9)-1))-5,a.y-9+2],A.h[n].star)}}}var be=n(66),me=n(67),Oe=n(110),ge=n(61),ye=n(100),je=n(103),xe=n(104),_e=n(34);var Se=function(e){return function(e){var t;return null===(t=e.match(/\((\w+)\)/))||void 0===t?void 0:t[1]}(e.AREA)+"_"+e.RANGE},ke=function(e){return e&&(e.endsWith("24+ ft.")||e.endsWith("Back Court Shot"))?3:2},Ae=Object(be.a)().x((function(e){return e.LOC_X})).y((function(e){return e.LOC_Y})).radius(7);[{GRID_TYPE:"League Averages",SHOT_ZONE_BASIC:"Above the Break 3",SHOT_ZONE_AREA:"Back Court(BC)",SHOT_ZONE_RANGE:"Back Court Shot",FGA:59,FGM:4,FG_PCT:.068},{GRID_TYPE:"League Averages",SHOT_ZONE_BASIC:"Above the Break 3",SHOT_ZONE_AREA:"Center(C)",SHOT_ZONE_RANGE:"24+ ft.",FGA:10885,FGM:3746,FG_PCT:.344},{GRID_TYPE:"League Averages",SHOT_ZONE_BASIC:"Above the Break 3",SHOT_ZONE_AREA:"Left Side Center(LC)",SHOT_ZONE_RANGE:"24+ ft.",FGA:16648,FGM:5802,FG_PCT:.349},{GRID_TYPE:"League Averages",SHOT_ZONE_BASIC:"Above the Break 3",SHOT_ZONE_AREA:"Right Side Center(RC)",SHOT_ZONE_RANGE:"24+ ft.",FGA:15837,FGM:5597,FG_PCT:.353},{GRID_TYPE:"League Averages",SHOT_ZONE_BASIC:"Backcourt",SHOT_ZONE_AREA:"Back Court(BC)",SHOT_ZONE_RANGE:"Back Court Shot",FGA:440,FGM:17,FG_PCT:.039},{GRID_TYPE:"League Averages",SHOT_ZONE_BASIC:"In The Paint (Non-RA)",SHOT_ZONE_AREA:"Center(C)",SHOT_ZONE_RANGE:"Less Than 8 ft.",FGA:19352,FGM:7561,FG_PCT:.391},{GRID_TYPE:"League Averages",SHOT_ZONE_BASIC:"In The Paint (Non-RA)",SHOT_ZONE_AREA:"Center(C)",SHOT_ZONE_RANGE:"8-16 ft.",FGA:6851,FGM:2889,FG_PCT:.422},{GRID_TYPE:"League Averages",SHOT_ZONE_BASIC:"In The Paint (Non-RA)",SHOT_ZONE_AREA:"Left Side(L)",SHOT_ZONE_RANGE:"8-16 ft.",FGA:2089,FGM:842,FG_PCT:.403},{GRID_TYPE:"League Averages",SHOT_ZONE_BASIC:"In The Paint (Non-RA)",SHOT_ZONE_AREA:"Right Side(R)",SHOT_ZONE_RANGE:"8-16 ft.",FGA:1932,FGM:799,FG_PCT:.414},{GRID_TYPE:"League Averages",SHOT_ZONE_BASIC:"Left Corner 3",SHOT_ZONE_AREA:"Left Side(L)",SHOT_ZONE_RANGE:"24+ ft.",FGA:7864,FGM:2939,FG_PCT:.374},{GRID_TYPE:"League Averages",SHOT_ZONE_BASIC:"Mid-Range",SHOT_ZONE_AREA:"Center(C)",SHOT_ZONE_RANGE:"16-24 ft.",FGA:7324,FGM:2897,FG_PCT:.396},{GRID_TYPE:"League Averages",SHOT_ZONE_BASIC:"Mid-Range",SHOT_ZONE_AREA:"Center(C)",SHOT_ZONE_RANGE:"8-16 ft.",FGA:2265,FGM:987,FG_PCT:.436},{GRID_TYPE:"League Averages",SHOT_ZONE_BASIC:"Mid-Range",SHOT_ZONE_AREA:"Left Side Center(LC)",SHOT_ZONE_RANGE:"16-24 ft.",FGA:7754,FGM:3066,FG_PCT:.395},{GRID_TYPE:"League Averages",SHOT_ZONE_BASIC:"Mid-Range",SHOT_ZONE_AREA:"Left Side(L)",SHOT_ZONE_RANGE:"8-16 ft.",FGA:7639,FGM:3005,FG_PCT:.393},{GRID_TYPE:"League Averages",SHOT_ZONE_BASIC:"Mid-Range",SHOT_ZONE_AREA:"Left Side(L)",SHOT_ZONE_RANGE:"16-24 ft.",FGA:5452,FGM:2173,FG_PCT:.399},{GRID_TYPE:"League Averages",SHOT_ZONE_BASIC:"Mid-Range",SHOT_ZONE_AREA:"Right Side Center(RC)",SHOT_ZONE_RANGE:"16-24 ft.",FGA:8145,FGM:3249,FG_PCT:.399},{GRID_TYPE:"League Averages",SHOT_ZONE_BASIC:"Mid-Range",SHOT_ZONE_AREA:"Right Side(R)",SHOT_ZONE_RANGE:"8-16 ft.",FGA:7630,FGM:3011,FG_PCT:.395},{GRID_TYPE:"League Averages",SHOT_ZONE_BASIC:"Mid-Range",SHOT_ZONE_AREA:"Right Side(R)",SHOT_ZONE_RANGE:"16-24 ft.",FGA:4924,FGM:1996,FG_PCT:.405},{GRID_TYPE:"League Averages",SHOT_ZONE_BASIC:"Restricted Area",SHOT_ZONE_AREA:"Center(C)",SHOT_ZONE_RANGE:"Less Than 8 ft.",FGA:67443,FGM:40634,FG_PCT:.602},{GRID_TYPE:"League Averages",SHOT_ZONE_BASIC:"Right Corner 3",SHOT_ZONE_AREA:"Right Side(R)",SHOT_ZONE_RANGE:"24+ ft.",FGA:7360,FGM:2803,FG_PCT:.381}].reduce((function(e,t){var n=Se({AREA:t.SHOT_ZONE_AREA,BASIC:t.SHOT_ZONE_BASIC,RANGE:t.SHOT_ZONE_RANGE});return e[n]={FGA:t.FGA,FGM:t.FGM,rate:t.FG_PCT,exp:ke(n)*t.FG_PCT},e}),{});function Ee(){var e=document.getElementById("canvasWrapper");if(!e)return{x:0,y:0};var t=null===e||void 0===e?void 0:e.getBoundingClientRect(),n=t.x,a=t.y,r=t.width,i=t.height;return{x:n,y:a+window.outerHeight/50,wScale:1280/r,hScale:720/i}}var we={regionScale:Object(me.a)(ye.a),twoPTColor:Object(Oe.a)(je.a).domain([.2,.8]),twoPT:Object(Oe.a)().domain([0,.4]).range([0,1]),threePTColor:Object(Oe.a)(je.a).domain([.2,.8]),threePT:Object(Oe.a)().domain([0,.27]).range([0,1]),radiusScale:Object(ge.b)().domain([0,1]).range([1,7]),regionExp:Object(Oe.a)(xe.a).domain([.1,"game1"===_e.a.GAME_ID?2:2.5])},Ie=n(6),Te=["0_bg","1_vis","2_fg","3_annot","4_debug"],Ce=function(e){Object(m.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(h.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).layers=Te.reduce((function(e,t){return e[t]=null,e}),{}),e.isOnLv2Player=function(e,t){return e.id in t&&(t[e.id].type.has(Q.Interest)&&t[e.id].on||t[e.id].type.has(Q.Normal))},e}return Object(p.a)(n,[{key:"get2DPos",value:function(e,t){var n=null===t||void 0===t?void 0:t.find((function(t){return t.id===e})),a=n.bbox,r=n.keypoints,i=A.h[e].team,o=a.y,c=a.h,s=r.left_hip,l=r.right_hip,u=r.left_ankle,d=r.right_ankle;return{cx:(s.x+l.x)/2,cy:(o+c+Math.max(u.y,d.y))/2,team:i}}},{key:"componentDidUpdate",value:function(){var e=Object(v.a)(f.a.mark((function e(t){var n,a,r,i,o,c,s,l,d,v,h,p,b,m,O,g,y,j,x,_,S,k=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.currentFrameIdx===this.props.currentFrameIdx){e.next=25;break}if(s=this.props,l=s.currentFrameIdx,d=s.currentFrame,v=s.features,h=s.playerFlags,d){e.next=4;break}return e.abrupt("return");case 4:if(this.cleanAllExcept("0_bg"),q(this.layers["0_bg"],d),$(this.layers["1_vis"],.18),p=null===(n=Ct.frames)||void 0===n?void 0:n[l]){e.next=10;break}return e.abrupt("return");case 10:if(b=p.players,m=p.ball,b){e.next=13;break}return e.abrupt("return");case 13:if(O=v.gaze_filter?Ct.fetchFocus():void 0,g=Ct.pickPlayers(l,v,h,O),y=g.lv1Players,j=g.lv2Players,y||j){e.next=17;break}return e.abrupt("return");case 17:null===(a=(r=this.props).onPickPlayers)||void 0===a||a.call(r,l,y,j),x=b.filter((function(e){return k.isOnLv2Player(e,j)})),_=x.filter((function(e){var t;return(null===(t=e.dataPkg)||void 0===t?void 0:t.mode)===K.offensive&&v.vis_off_ring})).map((function(e){var t=e.dataPkg,n=e.id,a=t,r=a.smoothRegionExp,i=a.inOffsensiveCourt,o=k.get2DPos(n,b);return{cx:o.cx,cy:o.cy,fill:we.regionExp(r),size:Math.min(1,r/2),inOffsensiveCourt:i}})),S=x.filter((function(e){var t;return(null===(t=e.dataPkg)||void 0===t?void 0:t.mode)===K.defensive&&v.vis_def_sheild})).map((function(e){var t=e.dataPkg,n=e.id,a=t,r=a.diff,i=a.speed,o=a.tangle,c=a.tdist,s=a.defendingPlayer,l=a.smoothDFdiff,u=k.get2DPos(n,b),d=u.cx,f=u.cy,v=k.get2DPos(s,b);return{cx:d,cy:f,dx:v.cx,dy:v.cy,diff:r,tangle:o,tdist:c,smoothDFdiff:l,speed:i}})),re(this.layers["1_vis"].ctx,_,S,null===(i=this.layers["4_debug"])||void 0===i||i.ctx),le(null===(o=this.layers["3_annot"])||void 0===o?void 0:o.ctx,this.layers["0_bg"].canvas,p.mask,b,null===b||void 0===b?void 0:b.filter((function(e){return e.id in y})).map((function(e){return Object(u.a)(Object(u.a)({},e),y[e.id])})),b.filter((function(e){return e.id in j})).map((function(e){return Object(u.a)(Object(u.a)({},e),j[e.id])})),v,null===m||void 0===m?void 0:m.playerId,O),pe(null===(c=this.layers["3_annot"])||void 0===c?void 0:c.ctx,b.find((function(e){return e.id===(null===m||void 0===m?void 0:m.playerId)}))),Object.values(j).filter((function(e){return e.type.has(Q.Interest)&&e.on})).forEach((function(e){var t;pe(null===(t=k.layers["3_annot"])||void 0===t?void 0:t.ctx,b.find((function(t){return t.id===e.id})))}));case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.currentVideo,n=null!==t&&void 0!==t?t:{},a=n.width,r=void 0===a?0:a,i=n.height,o=void 0===i?0:i;return Object(Ie.jsx)("div",{className:"visualizationContainer",style:{},children:Object(Ie.jsxs)("div",{id:"canvasWrapper",className:"canvasWrapper",children:[Object(Ie.jsx)("img",{alt:"www",src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",style:{height:"".concat(r/o*100,"%")}}),Te.map((function(t,n){return Object(Ie.jsx)("canvas",{id:t,width:r,height:o,ref:function(n){n&&(e.layers[t]={canvas:n,ctx:n.getContext("2d")})}},n)})),this.props.children]})})}},{key:"cleanAllExcept",value:function(e){var t=this;Object.keys(this.layers).filter((function(t){return t!==e})).forEach((function(e){var n=t.layers[e];null===n||void 0===n||n.ctx.clearRect(0,0,n.canvas.width,n.canvas.height)}))}}]),n}(r.a.Component);n(111),n(112),n(33),n(106),n(108),n(105);n(89);var Pe=A.j[0]/94,Le=Object(a.memo)((function(e){var t=e.isIn,n=e.d;return Object(Ie.jsx)("path",{className:"court_bin",fill:we.regionExp(n.regionExp),strokeWidth:t?2:0,d:"M".concat(n.x,",").concat(n.y).concat(Ae.hexagon())})})),Me=Object(a.memo)((function(e){var t=e.playerBins,n=e.currentBin;return Object(Ie.jsx)("svg",{width:A.j[0],height:"".concat(50*Pe,"px"),style:{position:"absolute",overflow:"visible"},children:Object(Ie.jsx)("g",{transform:"scale(".concat(A.j[0]/940,")"),children:null===t||void 0===t?void 0:t.map((function(e){var t=e.x===(null===n||void 0===n?void 0:n.x)&&e.y===(null===n||void 0===n?void 0:n.y);return Object(Ie.jsx)(Le,{d:e,isIn:t},"".concat(e.x,"_").concat(e.y))}))})})})),Fe=Object(a.memo)((function(e){var t=e.currentFrameData;if(!t)return Object(Ie.jsx)(Ie.Fragment,{});var n=t.players,a=t.ball,r=null===n||void 0===n?void 0:n.filter((function(e){var t=e.tracking;return void 0!==t.x&&void 0!==t.y})).map((function(e,t){var n,r=e.tracking,i=e.id,o=r.x,c=r.y,s=A.h[i].team;return Object(Ie.jsx)("div",{className:"marker",style:{top:c*Pe,left:o*Pe,backgroundColor:["GSW","LAC"].includes(s)?"steelblue":"#ff6347",color:(null===a||void 0===a?void 0:a.playerId)===i?"red":"#000",fontSize:(null===a||void 0===a?void 0:a.playerId)===i?"15px":"12px"},children:null===(n=A.h[i])||void 0===n?void 0:n.ln},i)}));a&&(null===r||void 0===r||r.push(Object(Ie.jsx)("div",{className:"marker",style:{top:a.tracking.y*Pe,left:a.tracking.x*Pe,backgroundColor:"orange"}},"ball")));var i=null===a||void 0===a?void 0:a.playerId,o=null===n||void 0===n?void 0:n.find((function(e){return e.id===i})),c=Ct.getCurrentBin(o),s=Ct.getPlayerBins(null===o||void 0===o?void 0:o.id);return Object(Ie.jsxs)("div",{className:"court",children:[i&&Object(Ie.jsx)(Me,{currentBin:c,playerBins:s}),r,Object(Ie.jsx)("img",{className:"court-img",style:{width:A.j[0]},src:"".concat("/iBall","/court.png")})]})}));Fe.displayName="Court";var Re=n(44),Ne=(n(90),n(50)),Ge=function(e){Object(m.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(h.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={isMoving:null,isAdjusting:null,cursorStatus:null},e.onResizeStart=function(t,n){if(0===t.button){t.stopPropagation();var a=e.props,r=a.x,i=a.w,o=t.clientX;e.setState({isAdjusting:{direction:n,oBBox:{x:r,w:i},ox:o},cursorStatus:"resizable"}),document.body.classList.add("adjusting",n)}},e.onResizing=function(t){var n,a,r=e.state.isAdjusting;if(null!==r&&0===t.button){t.preventDefault(),t.stopImmediatePropagation();var i=e.props,o=i.x,c=i.w,s=i.id,l=r.direction,u=r.oBBox,d=r.ox,f=t.clientX-d,v=e.props.getEW(s),h=v.wx,p=v.ex;switch(l){case"w":o=Math.min(u.x+u.w,u.x+f),o=Math.max(h,o),c=Math.min(u.x+u.w-h,u.w-f),c=Math.max(0,c);break;case"e":c=Math.max(0,u.w+f),c=Math.min(p-o,c)}null===(n=(a=e.props).onAdjusting)||void 0===n||n.call(a,e.props.id,{x:o,w:c})}},e.onResizeEnd=function(t){var n,a;if(null!==e.state.isAdjusting&&0===t.button){t.preventDefault(),t.stopImmediatePropagation();var r=e.props,i=r.x,o=r.w,c=r.id;null===(n=(a=e.props).onAdjustingEnd)||void 0===n||n.call(a,c,{x:i,w:o},!0),e.setState({isAdjusting:null}),document.body.classList.remove("adjusting","w","e","s","n")}},e.onMoveStart=function(t){if(0===t.button){t.stopPropagation(),t.preventDefault();var n=e.props.x,a=t.clientX;e.setState({isMoving:{ox:a-n},cursorStatus:"movable"})}},e.onMoving=function(t){var n,a,r=e.state.isMoving;if(null!==r){t.preventDefault(),t.stopImmediatePropagation();var i=t.clientX,o=e.props,c=o.w,s=o.id,l=e.props.getEW(s),u=l.wx,d=l.ex,f=Math.max(u,i-r.ox);f=Math.min(f,d-c),null===(n=(a=e.props).onMoving)||void 0===n||n.call(a,e.props.id,{x:f,w:c})}},e.onMoveEnd=function(t){null!==e.state.isMoving&&0===t.button&&(t.preventDefault(),t.stopImmediatePropagation(),e.setState({isMoving:null}))},e}return Object(p.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("mousemove",this.onMoving),window.addEventListener("mouseup",this.onMoveEnd),window.addEventListener("mousemove",this.onResizing),window.addEventListener("mouseup",this.onResizeEnd)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("mousemove",this.onMoving),window.removeEventListener("mouseup",this.onMoveEnd),window.removeEventListener("mousemove",this.onResizing),window.removeEventListener("mouseup",this.onResizeEnd)}},{key:"render",value:function(){var e=this,t=this.props,n=t.x,a=t.w,r=t.focused,i=(t.initializing,t.style),o=void 0===i?{}:i,c=this.state,s=c.isAdjusting,l=c.isMoving,d=c.cursorStatus;return Object(Ie.jsx)("div",{className:Object(Ne.a)("interval-container",{focused:r}),style:{left:n},children:Object(Ie.jsx)("div",{className:Object(Ne.a)("interval",d),style:Object(u.a)({width:a},o),onMouseDown:function(t){var n=t.currentTarget.parentElement.getBoundingClientRect(),r=t.clientX-n.x;Math.abs(r)<3?e.onResizeStart(t,"w"):Math.abs(r-a)<3?e.onResizeStart(t,"e"):e.onMoveStart(t)},onMouseMove:function(t){if(!s&&!l){var n=e.props.w,a=t.currentTarget.parentElement.getBoundingClientRect(),r=t.clientX-a.x;Math.abs(r)<3||Math.abs(r-n)<3?e.setState({cursorStatus:"resizable"}):e.setState({cursorStatus:"movable"})}},onClick:function(t){return e.props.onClickInterval(e.props.id)}})})}}]),n}(r.a.Component);function Be(e){return("0"+e).slice(-2)}function He(e){var t=Math.floor(1e3*e);e=Math.floor(t/1e3);var n=Math.floor(e/60);return e%=60,"".concat(Be(n%=60),":").concat(Be(e))}var De=Object(y.a)("pointer"),We=function(e){Object(m.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(h.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),Object.defineProperty(Object(b.a)(e),De,{writable:!0,value:r.a.createRef()}),e.imgWidth=1920*e.intervalSelectorHeight/1080,e.parentOffsetx=0,e.state={isDrawing:null},e.canvas=void 0,e.ctx=void 0,e.onDrawStart=function(t){if(0===t.button){var n=t.currentTarget.parentElement.getBoundingClientRect();e.parentOffsetx=-n.x+t.currentTarget.scrollLeft;var a=t.clientX,r=a+e.parentOffsetx;if(!(t.clientY>=n.bottom-8))if(e.props.enableClips){var i=e.props.clips;if(i.find((function(t){return e.frame2pos(t.interval.start)<=r&&r<=e.frame2pos(t.interval.end)}))){var o,c,s=e.pos2frame(r);null===(o=(c=e.props).onClickInterval)||void 0===o||o.call(c,-1,s)}else{for(var l,u,d=W(),f=0;f<i.length&&!(e.frame2pos(i[f].interval.start)>r);f++);var v={start:e.pos2frame(r),end:e.pos2frame(r+0)};null===(l=(u=e.props).onUpsertClip)||void 0===l||l.call(u,d,v),e.setState({isDrawing:{intervalId:d,omx:a,ox:r}})}}else{var h,p,b=e.pos2frame(r);null===(h=(p=e.props).onClickInterval)||void 0===h||h.call(p,-1,b)}}},e.onDrawing=function(t){var n,a,r=e.state.isDrawing;if(0===t.button&&null!==r&&e.props.enableClips){var i=e.props.clips,o=t.clientX,c=i.find((function(e){return e.id===r.intervalId}));if(c){var s=o-r.omx,l=e.getEW(c.id),u=l.wx,d=l.ex-r.ox,f=u-r.ox;s<f?s=f:s>d&&(s=d);var v=s>0?c.interval.start:e.pos2frame(Math.max(r.ox+s,0)),h=Math.abs(s),p=v+e.pos2frame(h);null===(n=(a=e.props).onUpsertClip)||void 0===n||n.call(a,c.id,{start:v,end:p})}}},e.onDrawEnd=function(t){var n,a,r=e.state.isDrawing;if(0===t.button&&null!==r&&e.props.enableClips){var i=e.props.clips,o=i.findIndex((function(e){return e.id===r.intervalId}));if(-1!==o){var c=i[o];e.setState({isDrawing:null});var s,l,u=c.interval,d=u.start;if(u.end-d<=2)null===(s=(l=e.props).onUpsertClip)||void 0===s||s.call(l,c.id,null);null===(n=(a=e.props).onClickInterval)||void 0===n||n.call(a,c.id,d)}}},e.updateInterval=function(t,n){var a,r,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e.props.enableClips){var o=e.props.clips,c=o.findIndex((function(e){return e.id===t})),s=o[c].interval,l=n.x?e.pos2frame(n.x):s.start,u=n.w?e.pos2frame(n.w)+l:s.end;null===(a=(r=e.props).onUpsertClip)||void 0===a||a.call(r,t,u-l<=2&&i?null:{start:l,end:u})}},e.getEW=function(t){if(e.props.enableClips){var n=e.props.clips,a=Object(b.a)(e).numberOfImg,r=n.findIndex((function(e){return e.id===t}));return{wx:0===r?e.parentOffsetx:e.frame2pos(n[r-1].interval.end)+1,ex:r===n.length-1?1920*e.intervalSelectorHeight/1080*a+e.parentOffsetx:e.frame2pos(n[r+1].interval.start)-1}}},e.pos2frame=function(t){var n=Object(b.a)(e),a=n.totalTrackWidth,r=n.globalMaxFrames;return Math.round(Math.min(t,a)/a*r)},e.frame2pos=function(t){var n=Object(b.a)(e),a=n.totalTrackWidth;return t/n.globalMaxFrames*a},e}return Object(p.a)(n,[{key:"globalMaxFrames",get:function(){return this.props.videos.reduce((function(e,t){return e+t.maxFrame}),-1)}},{key:"trackWidthFactor",get:function(){return this.globalMaxFrames<500?4:1}},{key:"totalTrackWidth",get:function(){return this.globalMaxFrames*this.trackWidthFactor}},{key:"globalCurFrameIdx",get:function(){var e=this.props,t=e.currentFrameIdx;return function(e,t,n){for(var a=0,r=0;r<e;++r)a+=n[r].maxFrame;return a+t}(e.currentVideoIdx,t,e.videos)}},{key:"maxTime",get:function(){return this.props.videos.reduce((function(e,t){return e+t.maxFrame/t.frameRate}),0)}},{key:"numberOfImg",get:function(){return 2*Math.ceil(this.maxTime)}},{key:"intervalSelectorHeight",get:function(){var e=this.props.mode,t=void 0===e?"M":e;return"M"===t?60:"S"===t?30:90}},{key:"containerHeight",get:function(){var e=this.props.containerHeightPadding,t=void 0===e?60:e;return this.intervalSelectorHeight+t}},{key:"componentDidMount",value:function(){this.props.enableClips&&(window.addEventListener("mousemove",this.onDrawing),window.addEventListener("mouseup",this.onDrawEnd))}},{key:"componentDidUpdate",value:function(e){if(e.currentFrameIdx!==this.props.currentFrameIdx&&Object(g.a)(this,De)[De].current){var t,n=Object(g.a)(this,De)[De].current.getBoundingClientRect();if(n.left>(window.innerWidth||document.documentElement.clientWidth)||n.right<0)console.log(n,window.innerWidth,document.documentElement.clientWidth),null===(t=Object(g.a)(this,De)[De].current.parentElement)||void 0===t||t.scrollTo({behavior:"smooth",left:n.left+400})}}},{key:"componentWillUnmount",value:function(){window.removeEventListener("mousemove",this.onDrawing),window.removeEventListener("mouseup",this.onDrawEnd)}},{key:"renderClips",value:function(){var e=this;if(this.props.enableClips){var t=this.props,n=t.clips,a=t.focusedClipId,r=this.state.isDrawing;return n.map((function(t,n){var i=t.id,o=t.interval;return Object(Ie.jsx)(Ge,Object(u.a)({id:i,x:e.frame2pos(o.start),w:e.frame2pos(o.end-o.start),style:{height:"".concat(e.intervalSelectorHeight+10,"px")},focused:a===i,onMoving:e.updateInterval,onAdjusting:e.updateInterval,onAdjustingEnd:e.updateInterval,getEW:e.getEW,initializing:(null===r||void 0===r?void 0:r.intervalId)===i,onClickInterval:function(t){var n,a;null===(n=(a=e.props).onClickInterval)||void 0===n||n.call(a,i,o.start)}},o),i)}))}}},{key:"render",value:function(){var e,t,n=this,a=this.props,r=a.currentFrameIdx,i=a.videos,o=this.maxTime,c=this.globalMaxFrames,s=this.intervalSelectorHeight,l=this.globalCurFrameIdx,u=this.containerHeight,d=r/(null!==(e=null===(t=i[0])||void 0===t?void 0:t.frameRate)&&void 0!==e?e:30);return Object(Ie.jsx)("div",{className:"timeline-container",style:{flex:"0 0 ".concat(u,"px")},children:Object(Ie.jsxs)("div",{className:"timeline",onMouseDown:this.onDrawStart,children:[Object(Ie.jsx)("div",{className:"time-info",children:Object(Ie.jsxs)("span",{children:[" ",He(d)," (",r,") / ",He(o)," (",c,")"]})}),Object(Ie.jsx)("div",{className:"pointer",ref:Object(g.a)(this,De)[De],style:{left:"calc(12px + ".concat(this.frame2pos(l),"px)")}}),Object(Ie.jsxs)("div",{id:"timeline-progress",className:"track-container",children:[i.map((function(e){var t,a;return Object(Ie.jsxs)("div",{className:"track",style:{width:"".concat(e.maxFrame*n.trackWidthFactor,"px"),height:s,backgroundColor:e.isTransit?"#515151":"rgb(116 99 57)",opacity:!e.isTransit&&1!==e.loadedData||1!==e.loadedVideo?.5:1},children:[Object(Ie.jsx)("span",{className:"video-name",children:e.id}),null===(t=(a=n.props).children)||void 0===t?void 0:t.call(a,n.totalTrackWidth,n.globalMaxFrames)]},e.id)})),this.renderClips()]})]})})}}]),n}(r.a.Component);n(91);var Ve=function(e){Object(m.a)(n,e);var t=Object(O.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e,t,n=this,a=this.props,r=a.currentVideo,i=a.currentFrameData,o=a.activeBBoxes,c=null!==r&&void 0!==r?r:{},s=c.height,l=void 0===s?0:s,u=c.width,d=void 0===u?0:u,f=null!==(e=null===i||void 0===i?void 0:i.players)&&void 0!==e?e:[],v=null!==(t=null===i||void 0===i?void 0:i.ball)&&void 0!==t?t:null;return Object(Ie.jsxs)("svg",{className:"overlay",height:l,width:d,viewBox:"0 0 ".concat(d," ").concat(l),preserveAspectRatio:"xMinYMin meet",onClick:function(e){var t,a;e.target===e.currentTarget&&(null===(t=(a=n.props).onClickBG)||void 0===t||t.call(a))},onContextMenu:this.props.onContextMenu,onDoubleClick:function(e){var t,a;e.target===e.currentTarget&&(null===(t=(a=n.props).onDBClick)||void 0===t||t.call(a))},children:[Object(Ie.jsx)("defs",{children:Object(Ie.jsxs)("filter",{x:"0",y:"0",width:"1",height:"1",id:"solid",children:[Object(Ie.jsx)("feFlood",{floodColor:"yellow",result:"bg"}),Object(Ie.jsxs)("feMerge",{children:[Object(Ie.jsx)("feMergeNode",{in:"bg"}),Object(Ie.jsx)("feMergeNode",{in:"SourceGraphic"})]})]})}),f.map((function(e,t){return Object(Ie.jsx)("rect",{className:"bbox ".concat((null===o||void 0===o?void 0:o.includes(e.id))?"active":""),x:e.bbox.x,y:e.bbox.y,width:e.bbox.w,height:e.bbox.h,onContextMenu:function(e){e.preventDefault(),e.stopPropagation()},onClick:function(a){var r,i;a.stopPropagation(),null===(r=(i=n.props).onClickPlayer)||void 0===r||r.call(i,e,t)}},t)})),v&&Object(Ie.jsx)("circle",{className:"ball ".concat((null===o||void 0===o?void 0:o.includes("ball"))?"active":""),cx:v.screenPos.x,cy:v.screenPos.y,r:5,onClick:function(e){var t,a;e.stopPropagation(),null===(t=(a=n.props).onClickBall)||void 0===t||t.call(a,v)}}),this.props.children]})}}]),n}(r.a.Component),Ze=function(e){Object(m.a)(n,e);var t=Object(O.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e,t=this.props,n=t.gaze,a=t.gazePlayers,r=t.bbox,i=void 0===r||r,o=t.currentFrameData,c=Object(Re.a)(t,["gaze","gazePlayers","bbox","currentFrameData"]),s=(null!==o&&void 0!==o?o:{}).players,l=(null!==(e=c.currentVideo)&&void 0!==e?e:{}).isTransit;return Object(Ie.jsxs)(Ve,Object(u.a)(Object(u.a)({},c),{},{children:[n&&Object(Ie.jsxs)("g",{transform:"translate(".concat(n.x,", ").concat(n.y,")"),children:[Object(Ie.jsx)("circle",{r:A.d,stroke:"red",fill:"rgba(255, 0, 0, 0.1)"}),Object(Ie.jsxs)("text",{textAnchor:"middle",fill:"#fff",alignmentBaseline:"middle",children:[n.x.toFixed(0),", ",n.y.toFixed(0),"fIdx: ",n.fIdx]})]}),!l&&i&&(null===s||void 0===s?void 0:s.filter((function(e){return e.dataPkg})).map((function(e){var t=e.bbox,n=e.id,r=e.dataPkg;return Object(Ie.jsxs)("g",{className:"bbox ".concat((null===a||void 0===a?void 0:a.some((function(e){return e.id===n})))?"active":""),transform:"translate(".concat(t.x,", ").concat(t.y,")"),children:[Object(Ie.jsx)("rect",{width:t.w,height:t.h}),r&&Object(Ie.jsx)("text",{fill:"#fff",alignmentBaseline:"middle",children:"".concat(r.mode,", v: ").concat(((null===r||void 0===r?void 0:r.mode)===K.defensive?r.diff:r.regionExp).toFixed(1))})]},n)})))]}))}}]),n}(r.a.Component),ze=(n(92),n(62)),Ue=function(e){Object(m.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(h.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={text:""},e}return Object(p.a)(n,[{key:"clean",value:function(){this.setState({text:""})}},{key:"render",value:function(){var e=this,t=this.state.text,n=this.props.onSend;return Object(Ie.jsxs)("div",{className:"control has-icons-left has-icons-right comment-box",children:[Object(Ie.jsx)("input",{className:"input",type:"text",placeholder:"Any thoughts? Enter to send..",value:t,onChange:function(t){return e.setState({text:t.target.value})},onKeyUp:function(e){"Enter"===e.key&&e.target===e.currentTarget&&""!==t.trim()&&(console.log("Enterterter",t),null===n||void 0===n||n(t))}}),Object(Ie.jsx)("span",{className:"icon is-left",children:Object(Ie.jsx)(ze.a,{style:{transform:"scale(1.5)"}})}),Object(Ie.jsx)("span",{className:"icon is-right",children:Object(Ie.jsx)(S.c,{style:{transform:"scale(1.5)"}})})]})}}]),n}(r.a.Component),Ye=(n(93),function(e){Object(m.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(h.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={y:50+200*Math.random()},e}return Object(p.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.id,n=e.onUpdateStatus;setTimeout((function(){n(t,"PLAYING")}),100),setTimeout((function(){n(t,"OVER")}),100+this.getDuration())}},{key:"getDuration",value:function(){var e=this.props.speed;return 7500/(void 0===e?1:e)}},{key:"render",value:function(){var e=this.props,t=e.content,n=e.color,a=void 0===n?"#fff":n,r=e.status,i=this.state.y,o=24*("PUSH"===r?2:1),c={transitionDuration:this.getDuration()+"ms",top:"".concat(i,"px"),fontSize:o,color:a};return Object(Ie.jsx)("div",{className:"danmu-message ".concat(r.toLowerCase()),style:c,children:t})}}]),n}(r.a.Component)),Je=function(e){Object(m.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(h.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={danmuQueue:[]},e.onUpdateStatus=function(t,n){var a=e.state.danmuQueue,r=a.find((function(e){return e.id===t}));r&&(r.state=n,e.setState({danmuQueue:Object(s.a)(a)}))},e}return Object(p.a)(n,[{key:"componentDidUpdate",value:function(e,t,n){var a=this;if(e.frameIdx!==this.props.frameIdx){var r=this.props.comments,i=this.state.danmuQueue,o=r.filter((function(e){return e.frameIdx===a.props.frameIdx&&e.videoId===a.props.videoId})).filter((function(e){return i.every((function(t){return t.id!==e.id}))}));this.setState({danmuQueue:[].concat(Object(s.a)(i.filter((function(e){return"OVER"!==e.state}))),Object(s.a)(o.map((function(e){return{id:e.id,content:e.content,state:"READY"}}))))})}}},{key:"push",value:function(e){var t=e.id,n=e.content,a=this.state.danmuQueue;this.setState({danmuQueue:[].concat(Object(s.a)(a),[{id:t,content:n,state:"PUSH"}])})}},{key:"render",value:function(){var e=this,t=this.state.danmuQueue;return Object(Ie.jsx)("div",{className:"danmu",children:Object(Ie.jsx)("div",{className:"danmu-screen",children:t.filter((function(e){return"OVER"!==e.state})).map((function(t){var n=t.id,a=t.state,r=t.content;return Object(Ie.jsx)(Ye,{id:n,status:a,content:r,color:"PUSH"===a?"#1E90FF":"#fff",onUpdateStatus:e.onUpdateStatus},n)}))})})}}]),n}(r.a.Component),Ke=n(20),Xe=n(18);function Qe(){return new Worker(n.p+"static/js/loadFrames.worker.204ea63a.js")}var qe=Object(y.a)("Loading"),$e=Object(y.a)("getFrames"),et=Object(y.a)("pre_load_batch_size"),tt=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qe;Object(h.a)(this,e),this.worker=n,Object.defineProperty(this,qe,{writable:!0,value:{}}),this.memVideoData={},this.onLoad=void 0,this.onUnload=void 0,Object.defineProperty(this,$e,{writable:!0,value:void 0}),Object.defineProperty(this,et,{writable:!0,value:50}),Object(g.a)(this,$e)[$e]=J(n,"Frames",(function(e){if("Progress"===e[0]){var n,a=Object(c.a)(e,3),r=(a[0],a[1]),i=a[2];null===(n=t.onLoad)||void 0===n||n.call(t,r,i)}}))}return Object(p.a)(e,[{key:"isLoaded",value:function(e){return e.isTransit||e.id in this.memVideoData}},{key:"getVideoData",value:function(e){return this.memVideoData[e]}},{key:"fetch",value:function(){var e=Object(v.a)(f.a.mark((function e(t){var n,a,r,i,o,c,l,d,h,p=this,b=arguments;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=b.length>1&&void 0!==b[1]&&b[1],!Object(g.a)(this,qe)[qe][t.id]){e.next=5;break}return e.next=4,N((function(){return!Object(g.a)(p,qe)[qe][t.id]}));case 4:return e.abrupt("return");case 5:if(Object(g.a)(this,qe)[qe][t.id]=!0,console.debug("preload===>",t),this.isLoaded(t)){e.next=43;break}return e.next=10,Object(g.a)(this,$e)[$e](t);case 10:if(i=e.sent){e.next=14;break}return Object(g.a)(this,qe)[qe][t.id]=!1,e.abrupt("return");case 14:o=.6,null===(a=this.onLoad)||void 0===a||a.call(this,t.id,o),console.log("%cMain thread processing ".concat(t.id," to mem =====>"),"color:#f5f5f5;background: #00695c; padding: 2px; border-radius:2px"),c=[],console.debug("===>parsing blob to img..."),l=0;case 20:if(!(l<Object.keys(i).length)){e.next=37;break}return h=i.slice(l,l+Object(g.a)(this,et)[et]),e.t0=[],e.t1=Object(s.a)(c),e.t2=s.a,e.next=27,Promise.all(h.map(function(){var e=Object(v.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V(URL.createObjectURL(t.mask));case 2:return n=e.sent,e.abrupt("return",Object(u.a)(Object(u.a)({},t),{},{mask:n}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 27:if(e.t3=e.sent,e.t4=(0,e.t2)(e.t3),c=e.t0.concat.call(e.t0,e.t1,e.t4),null===(d=this.onLoad)||void 0===d||d.call(this,t.id,o+(.95-o)*l/Object.keys(i).length),!n){e.next=34;break}return e.next=34,F(30);case 34:l+=Object(g.a)(this,et)[et],e.next=20;break;case 37:c.sort((function(e,t){return e.idx-t.idx})),console.debug("<=====".concat(t.id," Done!"),c[0]),this.memVideoData[t.id]=L(c,"idx"),null===(r=this.onLoad)||void 0===r||r.call(this,t.id,1),T&&H(),console.log("%cMain thread done processing ".concat(t.id," to mem<======"),"color:#f5f5f5;background: #00695c; padding: 2px; border-radius:2px");case 43:Object(g.a)(this,qe)[qe][t.id]=!1;case 44:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"unloadFromMem",value:function(e){var t;void 0===e||e.isTransit||(delete this.memVideoData[e.id],null===(t=this.onUnload)||void 0===t||t.call(this,e.id),T&&H())}}]),e}();n(63).a;var nt=Object(y.a)("Loading"),at=function(){function e(){Object(h.a)(this,e),Object.defineProperty(this,nt,{writable:!0,value:{}}),this.onLoad=void 0,this.onUnload=void 0,this.memVideos={}}return Object(p.a)(e,[{key:"getVideo",value:function(e){return this.memVideos[e]}},{key:"isLoaded",value:function(e){return e.id in this.memVideos}},{key:"fetch",value:function(){var e=Object(v.a)(f.a.mark((function e(t){var n,a,r=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(g.a)(this,nt)[nt][t.id]){e.next=4;break}return e.next=3,N((function(){return!Object(g.a)(r,nt)[nt][t.id]}));case 3:return e.abrupt("return");case 4:if(Object(g.a)(this,nt)[nt][t.id]=!0,this.isLoaded(t)){e.next=17;break}return console.debug("VideoLoader.preLoadToMem",t),(a=document.createElement("video")).src="".concat("/iBall","/assets/").concat(t.gameId,"/").concat(t.id,"/").concat(t.id,".mp4"),a.id=t.id,a.load(),e.next=13,new Promise((function(e){a.onloadeddata=e}));case 13:console.debug("VideoLoader.preLoadToMem ==> Done",t),this.memVideos[t.id]=a,null===(n=this.onLoad)||void 0===n||n.call(this,t.id),T&&H();case 17:Object(g.a)(this,nt)[nt][t.id]=!1;case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),rt=Object(y.a)("videoMeta"),it=Object(y.a)("video"),ot=function(){function e(t,n){var a=this;Object(h.a)(this,e),this.name=t,this.videoPlayer=n,Object.defineProperty(this,rt,{writable:!0,value:void 0}),Object.defineProperty(this,it,{writable:!0,value:void 0}),this.CallBackHandle=null,this.onPlay=null,this.onPause=null,this.invokeFrameHandlers=function(e,t){if(Object(g.a)(a,it)[it]===a.videoPlayer.currentTrack)for(var n=Math.round(t.mediaTime*Object(g.a)(a,rt)[rt].frameRate)-a.frameOffset,r=a.videoPlayer.currentTrack.id,i=0,o=a.videoPlayer.onFrameHandlers.length;i<o;++i)a.videoPlayer.onFrameHandlers[i].call(a,r,n,Date.now(),a.videoPlayer.currentTrack);var c;Object(g.a)(a,it)[it]&&(a.CallBackHandle=null===(c=Object(g.a)(a,it)[it])||void 0===c?void 0:c.requestVideoFrameCallback(a.invokeFrameHandlers))}}return Object(p.a)(e,[{key:"frameOffset",get:function(){var e;return 50===(null===(e=Object(g.a)(this,rt)[rt])||void 0===e?void 0:e.frameRate)?0:1}},{key:"video",get:function(){return Object(g.a)(this,it)[it]}},{key:"id",get:function(){var e;return null===(e=Object(g.a)(this,it)[it])||void 0===e?void 0:e.id}},{key:"setVideo",value:function(e,t){var n;Object(g.a)(this,it)[it]=t,null===(n=Object(g.a)(this,it)[it])||void 0===n||n.requestVideoFrameCallback(this.invokeFrameHandlers),Object(g.a)(this,rt)[rt]=e}},{key:"load",value:function(e,t){var n,a;this.onPlay=e,this.onPause=t,null===(n=Object(g.a)(this,it)[it])||void 0===n||n.addEventListener("play",e),null===(a=Object(g.a)(this,it)[it])||void 0===a||a.addEventListener("pause",t)}},{key:"unLoad",value:function(){var e,t,n,a;this.onPlay&&(null===(e=Object(g.a)(this,it)[it])||void 0===e||e.removeEventListener("play",this.onPlay)),this.onPause&&(null===(t=Object(g.a)(this,it)[it])||void 0===t||t.removeEventListener("pause",this.onPause)),null!==this.CallBackHandle&&(null===(n=Object(g.a)(this,it)[it])||void 0===n||n.cancelVideoFrameCallback(this.CallBackHandle)),null===(a=Object(g.a)(this,it)[it])||void 0===a||a.load(),Object(g.a)(this,it)[it]=void 0,Object(g.a)(this,rt)[rt]=void 0}},{key:"play",value:function(){var e;null===(e=Object(g.a)(this,it)[it])||void 0===e||e.play()}}]),e}(),ct=Object(y.a)("currentVideo"),st=function(){function e(){var t=this;Object(h.a)(this,e),this._currentTrack=void 0,Object.defineProperty(this,ct,{writable:!0,value:null}),this.videoSources=new at,this.ATrack=new ot("A",this),this.BTrack=new ot("B",this),this.onFrameHandlers=[],this.onPlay=void 0,this.onPause=void 0,this.onLoad=void 0,this.onUnload=void 0,this.videos=[],this.whichOnPause=function(e){var n,a,r=e.target;r.id===(null===(n=t.currentTrack)||void 0===n?void 0:n.id)&&(null===(a=t.onPause)||void 0===a||a.call(t,r.id))},this.whichOnPlay=function(e){var n,a,r=e.target;r.id===(null===(n=t.currentTrack)||void 0===n?void 0:n.id)&&(null===(a=t.onPlay)||void 0===a||a.call(t,r.id))},this.addOnFrameListener(function(){var e=Object(v.a)(f.a.mark((function e(n,a,r,i){var o,c,s,l,u;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-1!==(s=t.videos.findIndex((function(e){return e.id===n})))){e.next=4;break}return console.warn("There must be something wrong since it cannot find the video from the videoList in the videoPlayer",n,t.videos),e.abrupt("return");case 4:if(a+5===(null===(o=t.currentVideo)||void 0===o?void 0:o.maxFrame)&&(l=s+1,void 0!==t.videos[l]&&t.preloadToAnotherTrack(t.videos[l],!0)),a+1!==(null===(c=t.currentVideo)||void 0===c?void 0:c.maxFrame)){e.next=12;break}if(u=s+1,void 0!==t.videos[u]){e.next=10;break}return t.pause(),e.abrupt("return");case 10:return e.next=12,t.loadVideo(t.videos[u],!0);case 12:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}()),this.videoSources.onLoad=function(e){var n;null===(n=t.onLoad)||void 0===n||n.call(t,e,"Video")},this.videoSources.onUnload=function(e){var n;null===(n=t.onUnload)||void 0===n||n.call(t,e,"Video")}}return Object(p.a)(e,[{key:"currentTrack",get:function(){return this._currentTrack}},{key:"currentVideo",get:function(){return Object(g.a)(this,ct)[ct]},set:function(e){Object(g.a)(this,ct)[ct]=e}},{key:"addOnFrameListener",value:function(e){this.onFrameHandlers.splice(this.onFrameHandlers.length-2,0,e)}},{key:"fetchVideos",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t,n,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object(P.a)(this.videos),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=9;break}return a=n.value,e.next=7,this.videoSources.fetch(a);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])})));return function(){return e.apply(this,arguments)}}()},{key:"isLoaded",value:function(e){return this.videoSources.isLoaded(e)}},{key:"loadVideo",value:function(){var e=Object(v.a)(f.a.mark((function e(t){var n,a,r,i,o,s,l,u=arguments;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u.length>1&&void 0!==u[1]&&u[1],(null===(n=this.currentTrack)||void 0===n?void 0:n.id)!==t.id){e.next=3;break}return e.abrupt("return");case 3:if(this.currentVideo=t,this.ATrack.id===t.id||this.BTrack.id===t.id){e.next=7;break}return e.next=7,this.preloadToAnotherTrack(t,r);case 7:i=this.ATrack.id===t.id?[this.ATrack,this.BTrack]:[this.BTrack,this.ATrack],o=Object(c.a)(i,2),s=o[0],l=o[1],console.debug("TrackToLoad: ".concat(s.name,"_").concat(s.id," ").concat(null===(a=s.video)||void 0===a?void 0:a.currentTime,", TrackToUnload: ").concat(l.name,"_").concat(l.id)),l.unLoad(),s.load(this.whichOnPlay,this.whichOnPause),this._currentTrack=s.video;case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"preloadToAnotherTrack",value:function(){var e=Object(v.a)(f.a.mark((function e(t,n){var a,r,i,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("%cpreloadToSkip","background: #444; color: #bada55; padding: 2px; border-radius:2px",t),e.next=3,null===(a=this.videoSources)||void 0===a?void 0:a.fetch(t);case 3:o=this.BTrack.id===(null===(r=this.currentTrack)||void 0===r?void 0:r.id)?this.ATrack:this.BTrack,console.debug("Load to track_".concat(o.name)),o.setVideo(t,null===(i=this.videoSources)||void 0===i?void 0:i.getVideo(t.id)),n&&o.play();case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"play",value:function(){var e,t;this.currentTrack&&this.currentTrack.paused&&(console.debug("play video"),this.currentTrack.play(),null===(e=this.onPlay)||void 0===e||e.call(this,null===(t=this.currentTrack)||void 0===t?void 0:t.id))}},{key:"pause",value:function(){var e,t,n,a;(null===(e=this.currentTrack)||void 0===e?void 0:e.paused)||(null===(t=this.currentTrack)||void 0===t||t.pause(),null===(n=this.onPause)||void 0===n||n.call(this,null===(a=this.currentTrack)||void 0===a?void 0:a.id))}},{key:"seekTo",value:function(){var e=Object(v.a)(f.a.mark((function e(t,n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadVideo(t);case 2:this.currentTrack.currentTime=n/t.frameRate+.001,console.debug("switch to video:",t,"set currentTime to frameIdx",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),lt=Object(y.a)("frames"),ut=function(e){Object(m.a)(n,e);var t=Object(O.a)(n);function n(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new tt;return Object(h.a)(this,n),(e=t.call(this)).dataLoader=a,Object.defineProperty(Object(b.a)(e),lt,{writable:!0,value:void 0}),e.dataLoader.onLoad=function(t,n){var a,r;null===(a=(r=e).onLoad)||void 0===a||a.call(r,t,"Data",n)},e.dataLoader.onUnload=function(t){var n,a;null===(n=(a=e).onUnload)||void 0===n||n.call(a,t,"Data")},e}return Object(p.a)(n,[{key:"frames",get:function(){return Object(g.a)(this,lt)[lt]},set:function(e){Object(g.a)(this,lt)[lt]=e}},{key:"fetchVideos",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t,a,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(Ke.a)(Object(Xe.a)(n.prototype),"fetchVideos",this).call(this),t=Object(P.a)(this.videos),e.prev=2,t.s();case 4:if((a=t.n()).done){e.next=10;break}return r=a.value,e.next=8,this.dataLoader.fetch(r);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(){return e.apply(this,arguments)}}()},{key:"isLoaded",value:function(e){return this.dataLoader.isLoaded(e)&&Object(Ke.a)(Object(Xe.a)(n.prototype),"isLoaded",this).call(this,e)}},{key:"loadVideo",value:function(){var e=Object(v.a)(f.a.mark((function e(t){var a,r,i=arguments;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.length>1&&void 0!==i[1]&&i[1],(null===(a=this.currentTrack)||void 0===a?void 0:a.id)!==t.id){e.next=3;break}return e.abrupt("return");case 3:return Object(Ke.a)(Object(Xe.a)(n.prototype),"loadVideo",this).call(this,t,r),e.next=6,this.dataLoader.fetch(t);case 6:this.frames=this.dataLoader.getVideoData(t.id);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(st);function dt(){return new Worker(n.p+"static/js/loadData.worker.8a7f35a0.js")}var ft=Object(y.a)("getBins"),vt=function(e){Object(m.a)(n,e);var t=Object(O.a)(n);function n(){var e;return Object(h.a)(this,n),e=t.call(this,dt),Object.defineProperty(Object(b.a)(e),ft,{writable:!0,value:void 0}),e.playerBins={},Object(g.a)(Object(b.a)(e),ft)[ft]=J(e.worker,"Bins"),e}return Object(p.a)(n,[{key:"loadBins",value:function(){var e=Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.a)(this,ft)[ft]();case 2:this.playerBins=e.sent;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(tt),ht=Object(y.a)("gazeQueue"),pt=Object(y.a)("frameQueue"),bt=Object(y.a)("mousePos"),mt=Object(y.a)("playerAttentions"),Ot=Object(y.a)("keyPlayers"),gt=Object(y.a)("keyPlayer_buffer_size"),yt=Object(y.a)("getPlayerTeam"),jt=function(e){Object(m.a)(n,e);var t=Object(O.a)(n);function n(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new vt;return Object(h.a)(this,n),(e=t.call(this,a)).onGaze=void 0,e.onUpdateLvInt=void 0,e.onUpdateLvSync=void 0,Object.defineProperty(Object(b.a)(e),ht,{writable:!0,value:[]}),Object.defineProperty(Object(b.a)(e),pt,{writable:!0,value:[]}),Object.defineProperty(Object(b.a)(e),bt,{writable:!0,value:{x:0,y:0}}),e.onSocket=function(t){var n,a,r=JSON.parse(t.data),i=Math.round(1e3*r[1]),o=e.getClosetFrame(i);if(o){var c=Ee(),s=c.x,l=c.y,u=c.wScale,d=void 0===u?1:u,f=c.hScale,v=void 0===f?1:f,h=window.innerWidth/window.outerWidth,p=window.innerHeight/window.outerHeight,m={x:I?Object(g.a)(Object(b.a)(e),bt)[bt].x:(r[0][0]*h-s)*d,y:I?Object(g.a)(Object(b.a)(e),bt)[bt].y:((r[0][1]+20)*p-l)*v,ts:i,fIdx:null===o||void 0===o?void 0:o.fIdx,videoId:null===o||void 0===o?void 0:o.videoId};Object(g.a)(Object(b.a)(e),ht)[ht].push(m);var O=e.getLookAt(m);null===(n=(a=e).onGaze)||void 0===n||n.call(a,m,O),e.updateInteLv(m,O)}},Object.defineProperty(Object(b.a)(e),mt,{writable:!0,value:{lastTs:-1,fIdx:-1,videoId:void 0,players:{}}}),Object.defineProperty(Object(b.a)(e),Ot,{writable:!0,value:[]}),Object.defineProperty(Object(b.a)(e),gt,{writable:!0,value:100}),e.lastFocus={pos:{x:0,y:0}},Object.defineProperty(Object(b.a)(e),yt,{writable:!0,value:function(e){return e?A.h[e].team:void 0}}),I&&(document.body.addEventListener("mousemove",(function(t){var n,a=null===(n=document.getElementById("canvasWrapper"))||void 0===n?void 0:n.getBoundingClientRect();if(void 0!==a){var r=a.x,i=a.y,o=Ee(),c=o.wScale,s=void 0===c?1:c,l=o.hScale,u=void 0===l?1:l;Object(g.a)(Object(b.a)(e),bt)[bt]={x:(t.clientX-r)*s,y:(t.clientY-i)*u}}})),setInterval((function(){e.onSocket({data:JSON.stringify([[0,0],Date.now()/1e3])})}),1e3/30)),e}return Object(p.a)(n,[{key:"pushFrameHistory",value:function(e){Object(g.a)(this,pt)[pt].push(e)}},{key:"getClosetFrame",value:function(e){var t,n=1/0,a=void 0,r=Object(P.a)(Object(s.a)(Object(g.a)(this,pt)[pt]).reverse());try{for(r.s();!(t=r.n()).done;){var i=t.value,o=Math.abs(i.ts-e);if(!(o<n))break;n=o,a=i}}catch(c){r.e(c)}finally{r.f()}return a}},{key:"latestGaze",get:function(){return Object(g.a)(this,ht)[ht][Object(g.a)(this,ht)[ht].length-1]}},{key:"getClosetGaze",value:function(e){var t,n=1/0,a=void 0,r=Object(P.a)(Object(s.a)(Object(g.a)(this,ht)[ht]).reverse());try{for(r.s();!(t=r.n()).done;){var i=t.value,o=Math.abs(i.ts-e);if(!(o<n))break;n=o,a=i}}catch(c){r.e(c)}finally{r.f()}return a}},{key:"getLookAt",value:function(e){var t,n,a=e.x,r=e.y;if(e.videoId===(null===(t=this.currentVideo)||void 0===t?void 0:t.id)){var i=null===(n=this.frames)||void 0===n?void 0:n[e.fIdx];if(null===i||void 0===i?void 0:i.players){var o=A.d;return i.players.filter((function(e){var t=e.bbox;return a>t.x-o&&r>t.y-o&&a<t.x+t.w+o&&r<t.y+t.h+o}))}}}},{key:"updateInteLv",value:function(e,t){var n,a=e.ts,r=e.fIdx,i=Object(g.a)(this,mt)[mt],o=i.lastTs,c=i.players;var s=-1===o?c:Object.keys(c).reduce((function(e,t){var n,r,i,s,l=+t,u=(null!==(n=null===(r=c[l])||void 0===r?void 0:r.att)&&void 0!==n?n:0)*Math.pow(.2,(a-o)/500),d=null!==(i=null===(s=c[l])||void 0===s?void 0:s.on)&&void 0!==i&&i;return e[l]={on:!(u<A.e.off)&&d,att:u,looked:!1},e}),{});t&&t.forEach((function(e){var t,n,r=e.id;r in s||(s[r]={on:!1,att:0,looked:!0});var i,l,u=null!==(t=null===(n=c[r])||void 0===n?void 0:n.att)&&void 0!==t?t:0,d=(i=u,l=a-o,1-Math.pow(.2,(l-500*Math.log(1-i)/Math.log(5))/500)),f=d>A.e.on||s[r].on;s[r]={att:d,on:f,looked:!0}})),Object(g.a)(this,mt)[mt]={lastTs:a,fIdx:r,videoId:e.videoId,players:s},null===(n=this.onUpdateLvInt)||void 0===n||n.call(this,Object(g.a)(this,mt)[mt])}},{key:"getNextBallHolder",value:function(e,t,n,a){var r;t*=null===(r=this.currentVideo)||void 0===r?void 0:r.frameRate;for(var i=e;i<e+t;++i){var o,c=null===(o=this.frames)||void 0===o?void 0:o[i];if(c){var s=c.ball;if(null===s||void 0===s?void 0:s.playerId){if(!(null===n||void 0===n?void 0:n.playerId))return A.h[s.playerId].team===a?s.playerId:void 0;if(s.playerId!==n.playerId&&A.h[s.playerId].team===A.h[n.playerId].team)return s.playerId}}}}},{key:"getEmptyPlayer",value:function(e,t,n){if(void 0!==e&&void 0!==n){var a,r=e.filter((function(e){var t=e.tracking;return void 0!==t.x&&void 0!==t.y})),i=r.filter((function(e){return A.h[e.id].team!==n})),o=r.filter((function(e){return A.h[e.id].team===n})),c=[],s=Object(P.a)(o);try{var l=function(){var e=a.value,n=e.dataPkg;if(e.id===t)return"continue";if(!n.inOffsensiveCourt)return"continue";if(i.map((function(t){return U(t.tracking,e.tracking)})).every((function(e){return e>A.b}))){var r=function(e){var t=A.h[e].team;return new Set(["CLE","OKC"]).has(t)?{x:5.8,y:25}:{x:88.2,y:25}}(e.id),o=r.x,s=r.y,l=U(e.tracking,{x:o,y:s});c.push([e,l])}};for(s.s();!(a=s.n()).done;)l()}catch(u){s.e(u)}finally{s.f()}return c.sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}}},{key:"fetchFocus",value:function(){var e=this.latestGaze;if(!e)return this.lastFocus;var t=this.lastFocus.pos,n=Math.min(600,e.x-t.x),a=Math.min(600,e.y-t.y);return t={x:t.x+n,y:t.y+a},this.lastFocus={pos:t},this.lastFocus}},{key:"pickPlayers",value:function(e,t,n,a){var r,i,o,l,d=this;Object.keys(Object(g.a)(this,Ot)[Ot]).length>Object(g.a)(this,gt)[gt]&&Object(g.a)(this,Ot)[Ot].pop();var f=null===(r=this.frames)||void 0===r?void 0:r[e];if(!f)return{};var v=f.ball,h=f.players,p=f.teamWithBall,b=void 0===p?Object(g.a)(this,yt)[yt](null===h||void 0===h||null===(i=h.find((function(e){return e.id===(null===v||void 0===v?void 0:v.playerId)})))||void 0===i?void 0:i.id):p,m=Object(g.a)(this,mt)[mt].players,O=[],y=[];if(null===v||void 0===v?void 0:v.playerId){O.push({id:v.playerId,type:X.BALL_HOLDER}),y.push({id:v.playerId,type:new Set([Q.Normal])});var j=null===h||void 0===h?void 0:h.find((function(e){return e.id===v.playerId}));(null===j||void 0===j?void 0:j.tracking.defending)&&y.push({id:null===j||void 0===j?void 0:j.tracking.defending,type:new Set([Q.Normal])}),null===h||void 0===h||h.filter((function(e){return e.tracking.defending===v.playerId})).forEach((function(e){return y.push({id:e.id,type:new Set([Q.Normal])})}))}Object.entries(n).forEach((function(e){var t=Object(c.a)(e,2),n=t[0];"On"===t[1]&&O.push({id:+n,type:X.BALL_HOLDER})}));var x=this.getNextBallHolder(e,A.g,v);x&&O.length<A.f&&(O.push({id:x,type:X.NEXT_BALL_HOLDER}),y.push({id:x,type:new Set([Q.Normal])}));var _=t.vis_empty_player?this.getEmptyPlayer(null===h||void 0===h?void 0:h.filter((function(e){return!O.some((function(t){return t.id===e.id}))})),null===v||void 0===v?void 0:v.playerId,b):[];null===_||void 0===_||_.filter((function(e){var t=e.bbox;if(!a)return!0;var n=a.pos,r=n.x,i=n.y;return r>t.x-60&&i>t.y-60&&r<t.x+t.w+60&&i<t.y+t.h+60})).forEach((function(e){O.length+1<A.f&&(O.push({id:e.id,type:X.EMPTY_PLAYER}),y.push({id:e.id,type:new Set([Q.Normal])}))}));var S=null!==(o=null===(l=Object(g.a)(this,Ot)[Ot])||void 0===l?void 0:l[0])&&void 0!==o?o:{},k=S.players,E=void 0===k?[]:k,w=S.fIdx,I=void 0===w?0:w,T=S.videoId,C=(E=E.filter((function(e){var t;return T===(null===(t=d.currentVideo)||void 0===t?void 0:t.id)}))).filter((function(e){return!O.find((function(t){return e.id===t.id}))})).map((function(t){return t.last.status="exit",t.last.progress-=e-I,t})),P=E.filter((function(e){return!C.find((function(t){return t.id===e.id}))})).map((function(t){return t.last.progress=Math.min(6,t.last.progress+e-I),t.last.status=6===t.last.progress?"update":"enter",t})),L=O.filter((function(e){return!E.find((function(t){return t.id===e.id}))})).map((function(e){return e.last={status:"enter",progress:0},e})),F=[].concat(Object(s.a)(L),Object(s.a)(P),Object(s.a)(C.filter((function(e){return e.last.progress>0}))));return F.length>=A.f&&console.warn("More than the upper limit"),y=[].concat(Object(s.a)(y),Object(s.a)(F.map((function(e){return{id:e.id,type:new Set([Q.Normal])}})))),t.gaze_focus&&Object.entries(m).forEach((function(e){var t=Object(c.a)(e,2),n=t[0],a=t[1],r=a.att,i=a.on,o=a.looked;y.push({id:+n,att:r,on:i,looked:o,type:new Set([Q.Interest])})})),Object.entries(n).forEach((function(e){var t=Object(c.a)(e,2),n=t[0];"On"===t[1]&&y.push({id:+n,type:new Set([Q.Normal])})})),Object(g.a)(this,Ot)[Ot].unshift({fIdx:e,videoId:this.currentVideo.id,players:F}),{lv1Players:F.filter((function(e){return"Off"!==n[e.id]})).reduce((function(e,t){return t.id in e||(e[t.id]=t),t.type<e[t.id].type&&(e[t.id].type=t.type),e}),{}),lv2Players:y.filter((function(e){return"Off"!==n[e.id]||e.type.has(Q.Interest)})).reduce((function(e,t){return t.id in e?e[t.id]=Object(u.a)(Object(u.a)(Object(u.a)({},e[t.id]),t),{},{type:M(t.type,e[t.id].type)}):e[t.id]=t,e}),{}),teamWithBall:b,ballHolder:null===h||void 0===h?void 0:h.find((function(e){return e.id===(null===v||void 0===v?void 0:v.playerId)}))}}},{key:"loadBins",value:function(){var e=Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dataLoader.loadBins();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getPlayerBins",value:function(e){if(e)return this.dataLoader.playerBins[e]}},{key:"getCurrentBin",value:function(e){if(e){var t=e.tracking,n=t.x,a=t.y;return void 0!==n&&void 0!==a?Ae([{LOC_X:10*n,LOC_Y:10*a}])[0]:void 0}}}]),n}(ut),xt=n(64),_t=n(36),St=Object(xt.a)({apiKey:"AIzaSyBTOwT3aWd2qlfNj26EgMXUA7c4iKhHRYU",authDomain:"iball-126c5.firebaseapp.com",projectId:"iball-126c5",storageBucket:"iball-126c5.appspot.com",messagingSenderId:"482943654293",appId:"1:482943654293:web:43c0d22882e30e339dfe9c",measurementId:"G-SEJBKT58JL"}),kt=Object(_t.d)(St),At="comments";function Et(e){return wt.apply(this,arguments)}function wt(){return(wt=Object(v.a)(f.a.mark((function e(t){var n,a,r,i,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.pickedPlayers,a=Object(Re.a)(t,["pickedPlayers"]),r=n.lv1,i=n.lv2,e.next=5,Object(_t.a)(Object(_t.b)(kt,At),Object(u.a)(Object(u.a)({},a),{},{pickedPlayers:{lv1:r,lv2:Object.entries(i).reduce((function(e,t){var n=Object(c.a)(t,2),a=n[0],r=n[1];return e[+a]=Object(u.a)(Object(u.a)({},r),{},{id:r.id,type:Array.from(r.type)}),e}),{})}}));case 5:return o=e.sent,e.abrupt("return",o.id);case 9:e.prev=9,e.t0=e.catch(0),console.error("Error adding document: ",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function It(){return Tt.apply(this,arguments)}function Tt(){return(Tt=Object(v.a)(f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(_t.c)(Object(_t.b)(kt,At));case 2:return t=e.sent,n=[],t.forEach((function(e){var t=e.data(),a=t.content,r=t.gameId,i=t.videoId,o=t.frameIdx;n.push({id:e.id,content:a,gameId:r,videoId:i,frameIdx:o})})),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ct=new jt,Pt={vis_off_ring:!0,vis_def_sheild:!0,vis_key_player:!0,vis_empty_player:!0,vis_top_view:!0,gaze_focus:!0,gaze_filter:!0},Lt=Object(y.a)("visualizer"),Mt=Object(y.a)("commentBox"),Ft=Object(y.a)("danmu"),Rt=function(e){Object(m.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(h.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={pauseLoading:void 0,videos:[],currentVideoIdx:0,currentFrameIdx:0,currentFrame:void 0,currentGaze:void 0,gazePlayers:void 0,attentions:void 0,attentionsOverTime:void 0,pickedPlayers:{lv1:{},lv2:{}},comments:[],features:Pt,playerFlag:{},playing:!1},Object.defineProperty(Object(b.a)(e),Lt,{writable:!0,value:r.a.createRef()}),Object.defineProperty(Object(b.a)(e),Mt,{writable:!0,value:r.a.createRef()}),Object.defineProperty(Object(b.a)(e),Ft,{writable:!0,value:r.a.createRef()}),e.pushFrameHistory=function(t,n,a){var r=e.state.videos,i=r.findIndex((function(e){return e.id===t}));if(-1!==i){var o=r[i];Ct.pushFrameHistory({videoId:o.id,fIdx:n,ts:a})}else Ct.pause()},e.onClickInterval=function(){var t=Object(v.a)(f.a.mark((function t(n,a){var r,i,o,c;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.state.videos,i=z(a,r),o=i.videoIdx,c=i.frameIdx,Ct.pause(),t.next=5,Ct.seekTo(r[o],c);case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.onPlayVideo=Object(v.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.state.playing?Ct.pause():Ct.play();case 2:case"end":return t.stop()}}),t)}))),e}return Object(p.a)(n,[{key:"currentVideo",get:function(){return this.state.videos[this.state.currentVideoIdx]}},{key:"componentDidMount",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t,n,a,r,i=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(_e.a.VIDEO_IDS.map(function(){var e=Object(v.a)(f.a.mark((function e(t){var n,a,r,i,o,c,s,l,u;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat("/iBall","/assets/").concat(_e.a.GAME_ID,"/").concat(t,"/").concat(t,"-meta.json")).then((function(e){return e.json()}));case 3:return n=e.sent,a=n.max_frame,r=n.start_frame,i=void 0===r?0:r,o=n.fps,c=n.h,s=n.w,l=n.version,u=t.endsWith(",t"),e.abrupt("return",{gameId:_e.a.GAME_ID,id:t,maxFrame:a,startFame:i,isTransit:u,frameRate:o,loadedData:0,loadedVideo:0,width:s,height:c,version:l});case 15:throw e.prev=15,e.t0=e.catch(0),console.log("Something wrong with maxjson",t),e.t0;case 19:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}()));case 2:return n=e.sent,this.setState({videos:n}),Ct.videos=n,Ct.onGaze=function(e,t){return i.setState({currentGaze:e,gazePlayers:t})},Ct.onUpdateLvInt=function(e){return i.setState({attentions:e})},Ct.onLoad=function(e,t,n){var a=i.state.videos,r=a.findIndex((function(t){return t.id===e}));-1!==r&&(a[r]=Object(u.a)(Object(u.a)({},a[r]),{},Object(l.a)({},"loaded".concat(t),void 0===n?1:n)),i.setState({videos:Object(s.a)(a)}))},Ct.onUnload=function(e,t){var n=i.state.videos,a=n.findIndex((function(t){return t.id===e}));-1!==a&&(n[a]=Object(u.a)(Object(u.a)({},n[a]),{},Object(l.a)({},"loaded".concat(t),0)),i.setState({videos:Object(s.a)(n)}))},Ct.onPause=function(e){return i.setState({playing:!1})},Ct.onPlay=function(e){return i.setState({playing:!0,pauseLoading:void 0})},Ct.addOnFrameListener(this.pushFrameHistory),Ct.addOnFrameListener(function(){var e=Object(v.a)(f.a.mark((function e(t,n,a,r){var o,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=i.state.videos,c=o.findIndex((function(e){return e.id===t})),i.setState({currentFrameIdx:n,currentVideoIdx:c,currentFrame:r});case 3:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}()),a=this.state.currentVideoIdx,e.next=16,Ct.loadBins();case 16:return e.next=18,Ct.fetchVideos();case 18:return e.next=20,Ct.loadVideo(n[a]);case 20:return e.next=22,It();case 22:r=e.sent,this.setState({comments:r}),this.setState({playerFlag:Array.from(new Set(Object.values(null!==(t=Ct.frames)&&void 0!==t?t:{}).flatMap((function(e){var t;return null===(t=e.players)||void 0===t?void 0:t.map((function(e){return e.id}))})))).reduce((function(e,t){return t&&(e[t]="Auto"),e}),{})});case 25:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){}},{key:"loadedPrecentage",value:function(){var e=this.state.videos;return e.reduce((function(e,t){return e+(2*t.loadedData+t.loadedVideo)}),0)/e.reduce((function(e,t){return e+(t.isTransit?1:3)}),0)}},{key:"renderProgressbar",value:function(){var e=100*this.loadedPrecentage();return 100===e?null:Object(Ie.jsx)("div",{style:{position:"fixed",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:Object(Ie.jsxs)(_.a,{value:e,styles:Object(_.b)({pathColor:"rgb(62, 152, 199)",textColor:"#f88",trailColor:"#d6d6d6",backgroundColor:"#3e98c7"}),children:[Object(Ie.jsx)("div",{style:{color:"#f88",fontSize:"40px"},children:"".concat(0|e,"%")}),Object(Ie.jsx)("div",{style:{color:"#f88",fontSize:"24px"},children:"~1min"})]})})}},{key:"renderToggle",value:function(){var e=this,t=this.state.features;return Object(Ie.jsxs)("div",{className:"featurePanel",children:[Object(Ie.jsx)("h4",{style:{textAlign:"center"},children:"Features"}),Object.entries(t).filter((function(e){var t=Object(c.a)(e,2),n=t[0];t[1];return"onPlayers"!==n&&"offPlayers"!==n})).map((function(n){var a=Object(c.a)(n,2),r=a[0],i=a[1];return Object(Ie.jsxs)("div",{className:"featureItem",children:[Object(Ie.jsx)(x.a,{id:"cheese-status",checked:i,onChange:function(n){t[r]=!i,e.setState({features:t})}},r),Object(Ie.jsx)("span",{children:r.split("_").join(" ")})]},r)}))]})}},{key:"renderPlayerToggle",value:function(){var e=this,t=this.state.playerFlag;return Object(Ie.jsxs)("div",{className:"playerPanel",children:[Object(Ie.jsx)("h4",{style:{textAlign:"center"},children:"Players"}),Object(Ie.jsx)("div",{className:"btn-group",children:["Auto","On","Off"].map((function(t){return Object(Ie.jsxs)("button",{onClick:function(){var n=e.state.playerFlag;Object.keys(n).forEach((function(e){n[+e]=t})),e.setState({playerFlag:Object(u.a)({},n)})},children:[t," All"]},"btn_".concat(t))}))}),Object(Ie.jsx)("div",{className:"gridContainer",children:Object.entries(t).sort((function(e,t){var n=A.h[+e[0]].team,a=A.h[+t[0]].team;return n.localeCompare(a)})).map((function(n){var a=Object(c.a)(n,2),r=a[0],i=a[1],o=A.h[+r].team;return Object(Ie.jsxs)(Ie.Fragment,{children:[Object(Ie.jsx)("span",{className:"gridItem",style:{color:["GSW","LAC"].includes(o)?"steelblue":"#ff6347",fontWeight:500},children:A.h[+r].ln},"".concat(r,"_name")),Object(Ie.jsx)("label",{className:"gridItem",children:Object(Ie.jsx)("select",{name:"pflag",id:"pflag",value:i,onChange:function(n){t[+r]=n.target.value,e.setState({playerFlag:Object(u.a)({},t)})},children:["Auto","On","Off"].map((function(e){return Object(Ie.jsx)("option",{value:e,children:e},e)}))})},"".concat(r,"_select"))]})}))})]})}},{key:"render",value:function(){var e,t,n=this,a=this.state,r=a.currentVideoIdx,i=a.currentFrameIdx,o=a.features,c=a.playerFlag,l=a.currentGaze,u=a.currentFrame,d=a.gazePlayers,h=a.pauseLoading,p=(a.attentions,a.attentionsOverTime,a.pickedPlayers),b=a.comments,m=a.playing,O=a.videos,y=null===(e=Ct.frames)||void 0===e?void 0:e[i];return Object(Ie.jsxs)(Ie.Fragment,{children:[this.renderProgressbar(),o.vis_top_view&&Object(Ie.jsx)(Fe,{currentFrameData:y}),Object(Ie.jsxs)("div",{className:"up",children:[Object(Ie.jsxs)("div",{className:"left",children:[Object(Ie.jsx)("div",{style:{position:"absolute",zIndex:100,color:"#fff",fontSize:"1.5rem",marginLeft:"100px"},children:"Play the video and Try hovering on the players :)"}),Object(Ie.jsxs)(Ce,{ref:Object(g.a)(this,Lt)[Lt],currentVideo:this.currentVideo,currentFrameIdx:i,currentFrame:u,features:o,playerFlags:c,gaze:l,gazePlayers:d,onPickPlayers:function(e,t,a){-1!==O.findIndex((function(e){return e.id===n.currentVideo.id}))&&n.setState({pickedPlayers:{lv1:t,lv2:a}})},children:[Object(Ie.jsx)(Ze,{currentVideo:this.currentVideo,currentFrameData:y,gaze:E?l:void 0,gazePlayers:d,bbox:!1}),Object(Ie.jsx)(Je,{ref:Object(g.a)(this,Ft)[Ft],videoId:null===(t=this.currentVideo)||void 0===t?void 0:t.id,frameIdx:i,comments:b})]}),Object(Ie.jsxs)("div",{className:"controls",children:[Object(Ie.jsx)("button",{id:"playpause",className:"play button is-outlined",type:"button",disabled:void 0!==h||1!==this.loadedPrecentage(),onClick:function(){return n.onPlayVideo()},children:m?Object(Ie.jsx)(S.a,{style:{transform:"scale(1.5)"}}):void 0!==h?Object(Ie.jsx)(k.a,{style:{transform:"scale(1.5)"}}):Object(Ie.jsx)(S.b,{style:{transform:"scale(1.5)"}})}),Object(Ie.jsx)(Ue,{ref:Object(g.a)(this,Mt)[Mt],onSend:function(){var e=Object(v.a)(f.a.mark((function e(t){var a,r,l,u,d,v,h;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.currentVideo.gameId,r=n.currentVideo.id,l=i,e.next=5,Et({content:t.trim(),gameId:a,videoId:r,frameIdx:l,features:o,playerFlag:c,pickedPlayers:p});case 5:(u=e.sent)&&(h={id:u,content:t,gameId:a,videoId:r,frameIdx:l},n.setState({comments:[].concat(Object(s.a)(b),[h])}),null===(d=Object(g.a)(n,Ft)[Ft].current)||void 0===d||d.push(h),null===(v=Object(g.a)(n,Mt)[Mt].current)||void 0===v||v.clean());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})]})]}),Object(Ie.jsxs)("div",{className:"right",children:[this.renderToggle(),this.renderPlayerToggle()]})]}),w&&Object(Ie.jsx)(We,{mode:"S",videos:O,currentVideoIdx:r,currentFrameIdx:i,enableClips:!1,onClickInterval:this.onClickInterval})]})}}]),n}(r.a.Component);o.a.render(Object(Ie.jsx)(r.a.StrictMode,{children:Object(Ie.jsx)(Rt,{})}),document.getElementById("root"))}},[[94,1,2]]]);
//# sourceMappingURL=main.521786a6.chunk.js.map